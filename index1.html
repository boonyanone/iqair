<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Air Quality - Digital Signage</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Kanit', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            height: 100vh;
            overflow: hidden;
            padding: 20px;
        }
        
        /* === RESPONSIVE LAYOUTS === */
        .container {
            display: flex;
            height: calc(100vh - 40px);
            gap: 20px;
            transition: all 0.5s ease;
        }
        
        .container.landscape { flex-direction: row; }
        .container.portrait { flex-direction: column; }
        
        /* === IQAir-STYLE WIDGET === */
        .air-quality-section {
            flex: 1;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 25px;
            color: #333;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            position: relative;
        }
        
        .widget-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }
        
        .location-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: #333;
        }
        
        .followers-info {
            font-size: 0.8rem;
            color: #666;
            text-align: right;
        }
        
        /* === AQI MAIN CARD === */
        .aqi-main-card {
            background: linear-gradient(135deg, #4CAF50, #8BC34A);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            color: white;
            position: relative;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .aqi-main-card.moderate { background: linear-gradient(135deg, #FFEB3B, #FFC107); color: #333; }
        .aqi-main-card.unhealthy { background: linear-gradient(135deg, #FF9800, #FF5722); }
        .aqi-main-card.dangerous { background: linear-gradient(135deg, #F44336, #9C27B0); }
        
        .aqi-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }
        
        .aqi-number-box {
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 15px 20px;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        
        .aqi-number {
            font-size: 2.5rem;
            font-weight: 700;
            line-height: 1;
        }
        
        .aqi-label {
            font-size: 0.8rem;
            opacity: 0.9;
            margin-top: 5px;
        }
        
        .aqi-status {
            font-size: 1.8rem;
            font-weight: 700;
            text-align: center;
        }
        
        .mood-icon {
            font-size: 4rem;
            opacity: 0.8;
        }
        
        .pollutant-info {
            background: rgba(255,255,255,0.15);
            border-radius: 10px;
            padding: 12px 15px;
            margin: 15px 0;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        /* === WEATHER INFO GRID === */
        .weather-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 20px;
        }
        
        .weather-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            color: #333;
        }
        
        .weather-icon {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        
        .weather-value {
            font-size: 1.1rem;
            font-weight: 700;
            color: #667eea;
        }
        
        .weather-label {
            font-size: 0.8rem;
            color: #666;
            margin-top: 2px;
        }
        
        /* === ADVERTISEMENT SECTION === */
        .advertisement-section {
            flex: 1.5;
            background: rgba(255, 255, 255, 0.08);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 25px;
            display: flex;
            flex-direction: column;
            color: white;
        }
        
        .ad-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid rgba(255,255,255,0.1);
        }
        
        .ad-title {
            font-size: 1.4rem;
            font-weight: 700;
        }
        
        .ad-counter {
            background: rgba(255,255,255,0.2);
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        .ad-content {
            flex: 1;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(45deg, #667eea, #764ba2);
        }
        
        .ad-text {
            text-align: center;
            padding: 30px;
            font-size: 1.8rem;
            font-weight: 700;
            line-height: 1.4;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .ad-image, .ad-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 15px;
        }
        
        /* === STATUS INDICATORS === */
        .connection-status {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(76, 175, 80, 0.9);
            color: white;
            padding: 8px 15px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 600;
            backdrop-filter: blur(10px);
        }
        
        .mode-indicator {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 8px 12px;
            border-radius: 10px;
            font-size: 0.8rem;
            opacity: 0;
            transition: all 0.3s;
        }
        
        .mode-indicator.show { opacity: 1; }
        
        /* === RESPONSIVE === */
        @media (max-width: 768px) {
            .container { flex-direction: column !important; }
            .weather-grid { grid-template-columns: repeat(2, 1fr); }
            .aqi-number { font-size: 2rem; }
            .ad-text { font-size: 1.4rem; }
        }
        
        /* === PORTRAIT MODE === */
        .container.portrait .air-quality-section {
            flex: 0.8;
        }
        
        .container.portrait .advertisement-section {
            flex: 1.2;
        }
        
        /* === LOADING ANIMATION === */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }
        
        .loading-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #667eea;
            animation: loading 1.4s infinite ease-in-out both;
        }
        
        .loading-dot:nth-child(1) { animation-delay: -0.32s; }
        .loading-dot:nth-child(2) { animation-delay: -0.16s; }
        
        @keyframes loading {
            0%, 80%, 100% { transform: scale(0); }
            40% { transform: scale(1); }
        }
    </style>
</head>
<body>
    <div class="connection-status" id="status">üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î</div>
    <div class="mode-indicator" id="mode-indicator">üì∫ ‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô</div>
    
    <div class="container landscape" id="container">
        <!-- === AIR QUALITY WIDGET === -->
        <div class="air-quality-section">
            <!-- Header -->
            <div class="widget-header">
                <div>
                    <div class="location-title" id="location-title">Air quality in ‡∏£‡∏±‡∏ä‡πÄ‡∏ó‡∏ß‡∏µ</div>
                    <div class="followers-info" id="location-subtitle">
                        Air quality index (AQI) and PM2.5 air pollution ‚Ä¢ <span id="update-time">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</span>
                    </div>
                </div>
            </div>
            
            <!-- Main AQI Card -->
            <div class="aqi-main-card" id="aqi-card">
                <div class="aqi-header">
                    <div class="aqi-number-box">
                        <div class="aqi-number" id="aqi-value">--</div>
                        <div class="aqi-label">US AQI*</div>
                    </div>
                    <div class="aqi-status" id="aqi-status">Good</div>
                    <div class="mood-icon" id="mood-icon">üòä</div>
                </div>
                
                <!-- Main Pollutant -->
                <div class="pollutant-info" id="pollutant-info">
                    üå´Ô∏è <span>Main pollutant: PM2.5</span> | <strong id="pm25-value">-- Œºg/m¬≥</strong>
                </div>
            </div>
            
            <!-- Weather Grid -->
            <div class="weather-grid">
                <div class="weather-card">
                    <div class="weather-icon">üå§Ô∏è</div>
                    <div class="weather-value" id="temperature">--¬∞</div>
                    <div class="weather-label">‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥</div>
                </div>
                <div class="weather-card">
                    <div class="weather-icon">üå™Ô∏è</div>
                    <div class="weather-value" id="wind">-- km/h</div>
                    <div class="weather-label">‡∏•‡∏°</div>
                </div>
                <div class="weather-card">
                    <div class="weather-icon">üíß</div>
                    <div class="weather-value" id="humidity">--%</div>
                    <div class="weather-label">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô</div>
                </div>
            </div>
        </div>
        
        <!-- === ADVERTISEMENT SECTION === -->
        <div class="advertisement-section">
            <div class="ad-header">
                <div class="ad-title">üì¢ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡∏∞‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤</div>
                <div class="ad-counter" id="ad-counter">1/3</div>
            </div>
            
            <div class="ad-content" id="ad-content">
                <div class="ad-text">
                    <div class="loading">
                        <div class="loading-dot"></div>
                        <div class="loading-dot"></div>
                        <div class="loading-dot"></div>
                    </div>
                    <br>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤...
                </div>
            </div>
        </div>
    </div>

    <script>
        // === ‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£‡∏£‡∏∞‡∏ö‡∏ö ===
        var CONFIG = {
            API_KEY: '',
            CITY: 'Bangkok',
            STATE: 'Bangkok', 
            COUNTRY: 'Thailand',
            UPDATE_INTERVAL: 10 * 60 * 1000,
            AD_ROTATION_INTERVAL: 15 * 1000,
            MAX_FILE_SIZE: 50 * 1024 * 1024 // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô 50MB
        };
        
        var advertisements = [];
        var currentAdIndex = 0;
        var adRotationTimer = null;
        var currentLayout = 'landscape';
        
        // === ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö ===
        function init() {
            console.log('üöÄ Starting Digital Signage v2.1');
            loadSettings();
            loadAdvertisements();
            startSystem();
            setupKeyboardControls();
        }
        
        function loadSettings() {
            try {
                var settings = JSON.parse(localStorage.getItem('vipart_settings') || '{}');
                var location = JSON.parse(localStorage.getItem('vipart_location') || '{}');
                
                CONFIG.API_KEY = settings.apiKey || '';
                CONFIG.CITY = location.city || 'Bangkok';
                CONFIG.STATE = location.state || 'Bangkok';
                CONFIG.COUNTRY = location.country || 'Thailand';
                CONFIG.UPDATE_INTERVAL = (settings.updateInterval || 10) * 60 * 1000;
                CONFIG.AD_ROTATION_INTERVAL = (settings.adInterval || 15) * 1000;
                
                console.log('‚öôÔ∏è Settings loaded');
            } catch (error) {
                console.error('‚ùå Settings error:', error);
            }
        }
        
        function loadAdvertisements() {
            try {
                var stored = localStorage.getItem('vipart_advertisements');
                if (stored) {
                    advertisements = JSON.parse(stored);
                } else {
                    advertisements = getDefaultAds();
                }
                console.log('üì¢ Ads loaded:', advertisements.length);
            } catch (error) {
                console.error('‚ùå Ads loading error:', error);
                advertisements = getDefaultAds();
            }
        }
        
        function getDefaultAds() {
            return [
                {
                    type: 'text',
                    content: '<strong>üè¢ ‡πÇ‡∏ã‡∏•‡∏π‡∏ä‡∏±‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡∏õ‡πâ‡∏≤‡∏¢‡∏î‡∏¥‡∏à‡∏¥‡∏ó‡∏±‡∏•</strong><br>üì∫ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏¥‡∏ü‡∏ó‡πå‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î<br>‚ö° ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå<br>üéØ ‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏≠‡∏±‡∏à‡∏â‡∏£‡∏¥‡∏¢‡∏∞',
                    background: 'linear-gradient(45deg, #667eea, #764ba2)',
                    duration: 20000
                },
                {
                    type: 'text',
                    content: '<strong>üè† ‡∏Ñ‡∏≠‡∏ô‡πÇ‡∏î‡∏°‡∏¥‡πÄ‡∏ô‡∏µ‡∏¢‡∏°</strong><br>üìû 02-xxx-xxxx<br>üåü ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏ú‡∏π‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏±‡∏Å<br>üöÄ ‡∏™‡∏¥‡πà‡∏á‡∏≠‡∏≥‡∏ô‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡∏Ñ‡∏£‡∏ö‡∏Ñ‡∏£‡∏±‡∏ô',
                    background: 'linear-gradient(45deg, #11998e, #38ef7d)',
                    duration: 18000
                },
                {
                    type: 'text',
                    content: '<strong>üçï ‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£ ‡∏ä‡∏±‡πâ‡∏ô G</strong><br>‚è∞ ‡πÄ‡∏õ‡∏¥‡∏î 08:00 - 22:00<br>üéâ ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î 20% ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå<br>üì± ‡∏™‡∏±‡πà‡∏á‡∏ú‡πà‡∏≤‡∏ô Food Delivery',
                    background: 'linear-gradient(45deg, #f093fb, #f5576c)',
                    duration: 16000
                }
            ];
        }
        
        function startSystem() {
            updateStatus('üîÑ ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ API');
            
            if (CONFIG.API_KEY) {
                updateAirQuality();
                setInterval(updateAirQuality, CONFIG.UPDATE_INTERVAL);
            } else {
                showDemoData();
            }
            
            startAdRotation();
            
            // ‡πÅ‡∏™‡∏î‡∏á‡πÇ‡∏´‡∏°‡∏î‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
            showModeIndicator();
        }
        
        // === API Functions ===
        function updateAirQuality() {
            if (!CONFIG.API_KEY) {
                showDemoData();
                return;
            }
            
            updateStatus('üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó');
            
            var url = 'https://api.airvisual.com/v2/city?city=' + 
                     encodeURIComponent(CONFIG.CITY) + 
                     '&state=' + encodeURIComponent(CONFIG.STATE) + 
                     '&country=' + encodeURIComponent(CONFIG.COUNTRY) + 
                     '&key=' + CONFIG.API_KEY;
            
            makeApiCall(url);
        }
        
        function makeApiCall(url) {
            var xhr = new XMLHttpRequest();
            xhr.open('GET', url, true);
            xhr.timeout = 15000;
            
            xhr.onload = function() {
                if (xhr.status === 200) {
                    try {
                        var data = JSON.parse(xhr.responseText);
                        if (data && data.status === 'success' && data.data) {
                            processApiData(data.data);
                        } else {
                            handleApiError('API returned invalid data');
                        }
                    } catch (error) {
                        handleApiError('JSON parse error');
                    }
                } else {
                    handleApiError('HTTP ' + xhr.status);
                }
            };
            
            xhr.onerror = function() { handleApiError('Network error'); };
            xhr.ontimeout = function() { handleApiError('Request timeout'); };
            xhr.send();
        }
        
        function processApiData(data) {
            try {
                var current = data.current;
                var pollution = current.pollution;
                var weather = current.weather;
                
                // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó Location
                document.getElementById('location-title').textContent = 
                    'Air quality in ' + data.city;
                
                // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó AQI
                var aqiValue = pollution.aqius;
                var aqiData = getAQIData(aqiValue);
                
                document.getElementById('aqi-value').textContent = aqiValue;
                document.getElementById('aqi-status').textContent = aqiData.status;
                document.getElementById('mood-icon').textContent = aqiData.icon;
                
                var aqiCard = document.getElementById('aqi-card');
                aqiCard.className = 'aqi-main-card ' + aqiData.class;
                
                // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó PM2.5
                var pm25Value = (pollution.pm25 && pollution.pm25.v) ? pollution.pm25.v : '--';
                document.getElementById('pm25-value').textContent = pm25Value + ' Œºg/m¬≥';
                
                // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó Weather
                document.getElementById('temperature').textContent = 
                    weather.tp ? weather.tp + '¬∞' : '--¬∞';
                document.getElementById('wind').textContent = 
                    weather.ws ? weather.ws + ' km/h' : '-- km/h';
                document.getElementById('humidity').textContent = 
                    weather.hu ? weather.hu + '%' : '--%';
                
                // ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÄ‡∏ß‡∏•‡∏≤
                var now = new Date();
                document.getElementById('update-time').textContent = 
                    now.toLocaleString('th-TH');
                
                updateStatus('‚úÖ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î');
                
            } catch (error) {
                console.error('‚ùå Process data error:', error);
                handleApiError('Data processing error');
            }
        }
        
        function getAQIData(aqi) {
            if (aqi <= 50) return { 
                status: 'Good', 
                class: 'good', 
                icon: 'üòä' 
            };
            if (aqi <= 100) return { 
                status: 'Moderate', 
                class: 'moderate', 
                icon: 'üòê' 
            };
            if (aqi <= 150) return { 
                status: 'Unhealthy for Sensitive', 
                class: 'unhealthy', 
                icon: 'üò∑' 
            };
            if (aqi <= 200) return { 
                status: 'Unhealthy', 
                class: 'unhealthy', 
                icon: '‚ö†Ô∏è' 
            };
            return { 
                status: 'Hazardous', 
                class: 'dangerous', 
                icon: '‚ò†Ô∏è' 
            };
        }
        
        function handleApiError(error) {
            console.error('‚ùå API Error:', error);
            updateStatus('üìä ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Demo');
            showDemoData();
        }
        
        function showDemoData() {
            var demoData = {
                city: CONFIG.CITY,
                state: CONFIG.STATE,
                country: CONFIG.COUNTRY,
                current: {
                    pollution: { 
                        aqius: 38 + Math.floor(Math.random() * 30), 
                        pm25: { v: 12 + Math.floor(Math.random() * 20) } 
                    },
                    weather: { 
                        tp: 32 + Math.floor(Math.random() * 8), 
                        hu: 65 + Math.floor(Math.random() * 20),
                        ws: 8 + Math.floor(Math.random() * 15)
                    }
                }
            };
            processApiData(demoData);
        }
        
        // === Advertisement Functions ===
        function startAdRotation() {
            if (advertisements.length === 0) {
                advertisements = getDefaultAds();
            }
            
            displayCurrentAd();
            
            if (adRotationTimer) clearInterval(adRotationTimer);
            adRotationTimer = setInterval(function() {
                nextAd();
            }, CONFIG.AD_ROTATION_INTERVAL);
            
            console.log('üé¨ Ad rotation started');
        }
        
        function nextAd() {
            currentAdIndex = (currentAdIndex + 1) % advertisements.length;
            displayCurrentAd();
        }
        
        function prevAd() {
            currentAdIndex = currentAdIndex > 0 ? currentAdIndex - 1 : advertisements.length - 1;
            displayCurrentAd();
        }
        
        function displayCurrentAd() {
            var ad = advertisements[currentAdIndex];
            if (!ad) return;
            
            var adContent = document.getElementById('ad-content');
            var adCounter = document.getElementById('ad-counter');
            
            adCounter.textContent = (currentAdIndex + 1) + '/' + advertisements.length;
            
            // Smooth transition
            adContent.style.opacity = '0.7';
            adContent.style.transform = 'scale(0.95)';
            
            setTimeout(function() {
                if (ad.type === 'text') {
                    adContent.style.background = ad.background || 'linear-gradient(45deg, #667eea, #764ba2)';
                    adContent.innerHTML = '<div class="ad-text">' + ad.content + '</div>';
                } else if (ad.type === 'image') {
                    adContent.style.background = '#000';
                    adContent.innerHTML = '<img src="' + ad.src + '" class="ad-image" alt="Advertisement">';
                } else if (ad.type === 'video') {
                    adContent.style.background = '#000';
                    adContent.innerHTML = '<video src="' + ad.src + '" class="ad-video" autoplay muted loop></video>';
                }
                
                adContent.style.opacity = '1';
                adContent.style.transform = 'scale(1)';
            }, 300);
            
            console.log('üì¢ Ad ' + (currentAdIndex + 1) + '/' + advertisements.length);
        }
        
        // === Layout Controls ===
        function toggleLayout() {
            var container = document.getElementById('container');
            
            if (currentLayout === 'landscape') {
                container.className = 'container portrait';
                currentLayout = 'portrait';
                showModeIndicator('üì± ‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á');
            } else {
                container.className = 'container landscape';
                currentLayout = 'landscape';
                showModeIndicator('üì∫ ‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô');
            }
        }
        
        function showModeIndicator(text) {
            var indicator = document.getElementById('mode-indicator');
            indicator.textContent = text || ('üì∫ ' + (currentLayout === 'landscape' ? '‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô' : '‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á'));
            indicator.classList.add('show');
            
            setTimeout(function() {
                indicator.classList.remove('show');
            }, 2000);
        }
        
        // === Remote Control ===
        function setupKeyboardControls() {
            document.addEventListener('keydown', function(e) {
                console.log('Key:', e.keyCode);
                
                switch(e.keyCode) {
                    case 37: // Left
                        e.preventDefault();
                        prevAd();
                        break;
                    case 39: // Right
                        e.preventDefault();
                        nextAd();
                        break;
                    case 38: // Up
                    case 40: // Down
                        e.preventDefault();
                        toggleLayout();
                        break;
                    case 13: // Enter
                        e.preventDefault();
                        updateAirQuality();
                        showModeIndicator('üîÑ ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä');
                        break;
                    case 32: // Space
                        e.preventDefault();
                        if (adRotationTimer) {
                            clearInterval(adRotationTimer);
                            adRotationTimer = null;
                            showModeIndicator('‚è∏Ô∏è ‡∏´‡∏¢‡∏∏‡∏î');
                        } else {
                            startAdRotation();
                            showModeIndicator('‚ñ∂Ô∏è ‡πÄ‡∏£‡∏¥‡πà‡∏°');
                        }
                        break;
                }
            });
        }
        
        // === Utility Functions ===
        function updateStatus(message) {
            document.getElementById('status').textContent = message;
        }
        
        // === Storage Event Listener ===
        window.addEventListener('storage', function(e) {
            if (e.key === 'vipart_advertisements') {
                loadAdvertisements();
                if (adRotationTimer) clearInterval(adRotationTimer);
                startAdRotation();
            } else if (e.key === 'vipart_settings' || e.key === 'vipart_location') {
                loadSettings();
                updateAirQuality();
            }
        });
        
        // === Initialize ===
        window.addEventListener('load', function() {
            setTimeout(init, 1000);
        });
        
        console.log('üì∫ Digital Signage v2.1 Ready');
    </script>
</body>
</html>