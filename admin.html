<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Digital Signage Pro v3.0 - Admin Panel</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.min.js"></script>
    
    <style>
        :root {
            --primary-color: #667eea;
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --error-color: #ef4444;
            --info-color: #06b6d4;
            --surface-color: #ffffff;
            --background-color: #f8fafc;
            --border-color: #e5e7eb;
            --text-primary: #1f2937;
            --text-secondary: #6b7280;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
            --border-radius: 12px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Kanit', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--background-color);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* === LOGIN SYSTEM === */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: var(--primary-gradient);
            padding: 2rem;
        }

        .login-card {
            background: var(--surface-color);
            padding: 3rem;
            border-radius: 20px;
            box-shadow: var(--shadow-xl);
            width: 100%;
            max-width: 450px;
            text-align: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .login-logo {
            width: 80px;
            height: 80px;
            margin: 0 auto 1.5rem;
            background: var(--primary-gradient);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
        }

        .login-title {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .login-subtitle {
            color: var(--text-secondary);
            margin-bottom: 2rem;
        }

        /* === MAIN LAYOUT === */
        .admin-layout {
            display: none;
            min-height: 100vh;
            background: var(--background-color);
        }

        .admin-layout.show {
            display: flex;
        }

        /* === SIDEBAR === */
        .sidebar {
            width: 280px;
            background: var(--surface-color);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            z-index: 1000;
            box-shadow: var(--shadow-lg);
        }

        .sidebar-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
            background: var(--primary-gradient);
            color: white;
        }

        .sidebar-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1.25rem;
            font-weight: 700;
        }

        .sidebar-nav {
            flex: 1;
            padding: 1rem 0;
            overflow-y: auto;
        }

        .nav-item {
            margin: 0.25rem 1rem;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: var(--border-radius);
            transition: var(--transition);
            font-weight: 500;
        }

        .nav-link:hover {
            background: #f3f4f6;
            color: var(--primary-color);
        }

        .nav-link.active {
            background: var(--primary-gradient);
            color: white;
            box-shadow: var(--shadow-md);
        }

        .nav-icon {
            font-size: 1.25rem;
            width: 20px;
            text-align: center;
        }

        /* === MAIN CONTENT === */
        .main-content {
            margin-left: 280px;
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .topbar {
            background: var(--surface-color);
            border-bottom: 1px solid var(--border-color);
            padding: 1rem 2rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: var(--shadow-sm);
            position: sticky;
            top: 0;
            z-index: 100;
        }

        .topbar-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .topbar-actions {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .content-area {
            flex: 1;
            padding: 2rem;
            overflow-y: auto;
        }

        /* === CARDS AND COMPONENTS === */
        .card {
            background: var(--surface-color);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            overflow: hidden;
            transition: var(--transition);
        }

        .card:hover {
            box-shadow: var(--shadow-md);
        }

        .card-header {
            padding: 1.5rem;
            border-bottom: 1px solid var(--border-color);
            background: #f9fafb;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .card-body {
            padding: 1.5rem;
        }

        /* === FORM ELEMENTS === */
        .form-group {
            margin-bottom: 1.5rem;
        }

        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .form-input {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            font-family: inherit;
            font-size: 1rem;
            transition: var(--transition);
            background: var(--surface-color);
        }

        .form-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-textarea {
            min-height: 120px;
            resize: vertical;
        }

        /* === BUTTONS === */
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.75rem 1.5rem;
            font-family: inherit;
            font-size: 1rem;
            font-weight: 600;
            text-decoration: none;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: var(--transition);
            text-align: center;
            white-space: nowrap;
        }

        .btn-primary {
            background: var(--primary-gradient);
            color: white;
            box-shadow: var(--shadow-md);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn-success {
            background: var(--success-color);
            color: white;
        }

        .btn-warning {
            background: var(--warning-color);
            color: white;
        }

        .btn-error {
            background: var(--error-color);
            color: white;
        }

        .btn-secondary {
            background: #f3f4f6;
            color: var(--text-primary);
            border: 1px solid var(--border-color);
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: var(--shadow-md);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* === GRID SYSTEM === */
        .grid {
            display: grid;
            gap: 1.5rem;
        }

        .grid-cols-1 { grid-template-columns: repeat(1, minmax(0, 1fr)); }
        .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        .grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        .grid-cols-4 { grid-template-columns: repeat(4, minmax(0, 1fr)); }

        /* === TABS === */
        .tab-container {
            margin-bottom: 2rem;
        }

        .tab-list {
            display: flex;
            gap: 0.5rem;
            border-bottom: 2px solid var(--border-color);
            margin-bottom: 1.5rem;
        }

        .tab-button {
            padding: 0.75rem 1.5rem;
            background: none;
            border: none;
            font-family: inherit;
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-secondary);
            cursor: pointer;
            transition: var(--transition);
            border-radius: var(--border-radius) var(--border-radius) 0 0;
            position: relative;
        }

        .tab-button.active {
            color: var(--primary-color);
        }

        .tab-button.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: var(--primary-color);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* === QUICK INSERT BUTTONS === */
        .quick-insert {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin: 1rem 0;
        }

        .quick-btn {
            background: var(--primary-gradient);
            color: white;
            border: none;
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius);
            font-family: inherit;
            font-size: 0.875rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
        }

        .quick-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        /* === RICH TEXT EDITOR === */
        .editor-container {
            margin: 1rem 0;
            border: 2px solid var(--border-color);
            border-radius: var(--border-radius);
            overflow: hidden;
            transition: var(--transition);
        }

        .editor-container:focus-within {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .ql-toolbar {
            border: none !important;
            border-bottom: 1px solid var(--border-color) !important;
            background: #f9fafb;
        }

        .ql-container {
            border: none !important;
            font-family: 'Kanit', sans-serif !important;
            font-size: 1rem !important;
            min-height: 200px;
        }

        .ql-editor {
            min-height: 200px;
            padding: 1.5rem;
            line-height: 1.6;
        }

        /* === BACKGROUND COLOR PICKER === */
        .bg-picker {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin: 1rem 0;
        }

        .bg-color {
            width: 48px;
            height: 48px;
            border-radius: var(--border-radius);
            cursor: pointer;
            border: 3px solid transparent;
            transition: var(--transition);
            position: relative;
            overflow: hidden;
        }

        .bg-color:hover,
        .bg-color.active {
            border-color: var(--primary-color);
            transform: scale(1.05);
            box-shadow: var(--shadow-md);
        }

        .bg-color.active::after {
            content: '‚úì';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-weight: bold;
            text-shadow: 0 0 4px rgba(0,0,0,0.5);
        }

        /* === ADVERTISEMENT LIST === */
        .ad-grid {
            display: grid;
            gap: 1.5rem;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        }

        .ad-item {
            background: var(--surface-color);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-sm);
            border: 1px solid var(--border-color);
            overflow: hidden;
            transition: var(--transition);
        }

        .ad-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        .ad-preview {
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            text-align: center;
            padding: 1rem;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .ad-item-body {
            padding: 1rem;
        }

        .ad-item-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
        }

        .ad-item-meta {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 1rem;
        }

        .ad-item-actions {
            display: flex;
            gap: 0.5rem;
        }

        .ad-item-actions .btn {
            flex: 1;
            padding: 0.5rem 1rem;
            font-size: 0.875rem;
        }

        /* === PREVIEW SECTION === */
        .preview-container {
            max-width: 800px;
            margin: 0 auto;
        }

        .preview-display {
            background: var(--primary-gradient);
            border-radius: var(--border-radius);
            min-height: 300px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow-lg);
            overflow: hidden;
            transition: var(--transition);
        }

        .preview-text {
            color: white;
            text-align: center;
            font-weight: 700;
            font-size: 1.5rem;
            line-height: 1.5;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
            padding: 2rem;
        }

        .preview-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            background: var(--surface-color);
            padding: 1rem;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-sm);
        }

        .preview-counter {
            background: var(--primary-gradient);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: var(--border-radius);
            font-weight: 600;
        }

        /* === SAMPLE GALLERY === */
        .sample-gallery {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .sample-item {
            aspect-ratio: 16/9;
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
            overflow: hidden;
            padding: 1rem;
        }

        .sample-item:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }

        /* === STATUS INDICATORS === */
        .status-indicator {
            position: fixed;
            top: 2rem;
            right: 2rem;
            background: var(--success-color);
            color: white;
            padding: 0.75rem 1rem;
            border-radius: var(--border-radius);
            font-weight: 600;
            box-shadow: var(--shadow-lg);
            z-index: 9999;
            transition: var(--transition);
        }

        .status-indicator.error {
            background: var(--error-color);
        }

        .status-indicator.warning {
            background: var(--warning-color);
        }

        .status-indicator.info {
            background: var(--info-color);
        }

        /* === ALERTS === */
        .alert {
            padding: 1rem 1.5rem;
            border-radius: var(--border-radius);
            margin-bottom: 1rem;
            border: 1px solid transparent;
            font-weight: 500;
            display: none;
            transition: var(--transition);
        }

        .alert.show {
            display: block;
            animation: slideInDown 0.3s ease;
        }

        .alert-success {
            background: #ecfdf5;
            color: #065f46;
            border-color: #a7f3d0;
        }

        .alert-error {
            background: #fef2f2;
            color: #991b1b;
            border-color: #fca5a5;
        }

        .alert-warning {
            background: #fffbeb;
            color: #92400e;
            border-color: #fde68a;
        }

        .alert-info {
            background: #eff6ff;
            color: #1e40af;
            border-color: #93c5fd;
        }

        /* === ANIMATIONS === */
        @keyframes slideInDown {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* === RESPONSIVE === */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
                transition: transform 0.3s ease;
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .main-content {
                margin-left: 0;
            }

            .topbar {
                padding: 1rem;
            }

            .content-area {
                padding: 1rem;
            }

            .grid-cols-3 {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }

            .grid-cols-4 {
                grid-template-columns: repeat(2, minmax(0, 1fr));
            }
        }

        @media (max-width: 640px) {
            .login-card {
                padding: 2rem;
                margin: 1rem;
            }

            .grid-cols-2 {
                grid-template-columns: repeat(1, minmax(0, 1fr));
            }

            .ad-item-actions {
                flex-direction: column;
            }

            .tab-list {
                flex-wrap: wrap;
            }

            .preview-controls {
                flex-direction: column;
                gap: 0.75rem;
            }

            .quick-insert {
                justify-content: center;
            }
        }

        /* === UTILITY CLASSES === */
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .mb-0 { margin-bottom: 0; }
        .mb-1 { margin-bottom: 0.5rem; }
        .mb-2 { margin-bottom: 1rem; }
        .mb-3 { margin-bottom: 1.5rem; }
        .mt-1 { margin-top: 0.5rem; }
        .mt-2 { margin-top: 1rem; }
        .mt-3 { margin-top: 1.5rem; }
        .p-0 { padding: 0; }
        .p-1 { padding: 0.5rem; }
        .p-2 { padding: 1rem; }
        .flex { display: flex; }
        .flex-col { flex-direction: column; }
        .items-center { align-items: center; }
        .justify-center { justify-content: center; }
        .justify-between { justify-content: space-between; }
        .gap-1 { gap: 0.5rem; }
        .gap-2 { gap: 1rem; }
        .gap-3 { gap: 1.5rem; }
        .w-full { width: 100%; }
        .h-full { height: 100%; }
        .hidden { display: none; }
        .block { display: block; }
    </style>
</head>
<body>
    <!-- Status Indicator -->
    <div class="status-indicator" id="statusIndicator">
        üîÑ ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°
    </div>

    <!-- Login Form -->
    <div class="login-container" id="loginContainer">
        <div class="login-card">
            <div class="login-logo">üéØ</div>
            <h1 class="login-title">Digital Signage Pro</h1>
            <p class="login-subtitle">v3.0 Admin Panel</p>
            
            <form id="loginForm" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label class="form-label" for="username">üë§ ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ</label>
                    <input type="text" id="username" class="form-input" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ" value="admin" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label" for="password">üîë ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô</label>
                    <input type="password" id="password" class="form-input" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" required>
                </div>
                
                <button type="submit" class="btn btn-primary w-full">
                    üöÄ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
                </button>
            </form>
            
            <div class="alert alert-error" id="loginError">
                ‚ùå ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á
            </div>
        </div>
    </div>

    <!-- Admin Layout -->
    <div class="admin-layout" id="adminLayout">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <div class="sidebar-logo">
                    <span>üéØ</span>
                    <span>Digital Signage Pro</span>
                </div>
            </div>
            
            <nav class="sidebar-nav">
                <div class="nav-item">
                    <a href="#" class="nav-link active" onclick="switchTab('dashboard')" data-tab="dashboard">
                        <span class="nav-icon">üìä</span>
                        <span>‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" onclick="switchTab('api')" data-tab="api">
                        <span class="nav-icon">üîë</span>
                        <span>API Configuration</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" onclick="switchTab('ads')" data-tab="ads">
                        <span class="nav-icon">üì¢</span>
                        <span>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" onclick="switchTab('preview')" data-tab="preview">
                        <span class="nav-icon">üëÅÔ∏è</span>
                        <span>‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" onclick="switchTab('sync')" data-tab="sync">
                        <span class="nav-icon">‚òÅÔ∏è</span>
                        <span>Cloud Sync</span>
                    </a>
                </div>
                <div class="nav-item">
                    <a href="#" class="nav-link" onclick="switchTab('settings')" data-tab="settings">
                        <span class="nav-icon">‚öôÔ∏è</span>
                        <span>‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</span>
                    </a>
                </div>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Topbar -->
            <header class="topbar">
                <h1 class="topbar-title" id="pageTitle">üìä ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î</h1>
                <div class="topbar-actions">
                    <button class="btn btn-secondary" onclick="openMainPage()">
                        üñ•Ô∏è ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
                    </button>
                    <button class="btn btn-error" onclick="handleLogout()">
                        üö™ ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö
                    </button>
                </div>
            </header>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Dashboard Tab -->
                <div id="tab-dashboard" class="tab-content active">
                    <div class="grid grid-cols-4 mb-3">
                        <div class="card">
                            <div class="card-body text-center">
                                <div style="font-size: 2rem; margin-bottom: 0.5rem;">üì¢</div>
                                <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary-color);" id="totalAds">0</div>
                                <div style="color: var(--text-secondary);">‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</div>
                           </div>
                       </div>
                       <div class="card">
                           <div class="card-body text-center">
                               <div style="font-size: 2rem; margin-bottom: 0.5rem;">üîÑ</div>
                               <div style="font-size: 1.5rem; font-weight: 700; color: var(--success-color);" id="syncCount">0</div>
                               <div style="color: var(--text-secondary);">Sync ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</div>
                           </div>
                       </div>
                       <div class="card">
                           <div class="card-body text-center">
                               <div style="font-size: 2rem; margin-bottom: 0.5rem;">üåê</div>
                               <div style="font-size: 1.5rem; font-weight: 700; color: var(--info-color);" id="apiStatus">‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå</div>
                               <div style="color: var(--text-secondary);">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞ API</div>
                           </div>
                       </div>
                       <div class="card">
                           <div class="card-body text-center">
                               <div style="font-size: 2rem; margin-bottom: 0.5rem;">‚è∞</div>
                               <div style="font-size: 1rem; font-weight: 700; color: var(--warning-color);" id="lastUpdate">‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢</div>
                               <div style="color: var(--text-secondary);">‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î</div>
                           </div>
                       </div>
                   </div>

                   <div class="grid grid-cols-2">
                       <div class="card">
                           <div class="card-header">
                               <h3 class="card-title">üìä ‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö</h3>
                           </div>
                           <div class="card-body">
                               <div class="mb-2">
                                   <div class="flex justify-between mb-1">
                                       <span>üì± ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û‡∏£‡∏∞‡∏ö‡∏ö</span>
                                       <span>95%</span>
                                   </div>
                                   <div style="width: 100%; height: 8px; background: #e5e7eb; border-radius: 4px;">
                                       <div style="width: 95%; height: 100%; background: var(--success-color); border-radius: 4px;"></div>
                                   </div>
                               </div>
                               <div class="mb-2">
                                   <div class="flex justify-between mb-1">
                                       <span>üíæ ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏´‡∏ô‡πà‡∏ß‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥</span>
                                       <span>67%</span>
                                   </div>
                                   <div style="width: 100%; height: 8px; background: #e5e7eb; border-radius: 4px;">
                                       <div style="width: 67%; height: 100%; background: var(--warning-color); border-radius: 4px;"></div>
                                   </div>
                               </div>
                               <div>
                                   <div class="flex justify-between mb-1">
                                       <span>üîÑ ‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£ Sync</span>
                                       <span>89%</span>
                                   </div>
                                   <div style="width: 100%; height: 8px; background: #e5e7eb; border-radius: 4px;">
                                       <div style="width: 89%; height: 100%; background: var(--info-color); border-radius: 4px;"></div>
                                   </div>
                               </div>
                           </div>
                       </div>

                       <div class="card">
                           <div class="card-header">
                               <h3 class="card-title">‚ö° ‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏î‡πà‡∏ß‡∏ô</h3>
                           </div>
                           <div class="card-body">
                               <div class="flex flex-col gap-2">
                                   <button class="btn btn-primary" onclick="switchTab('ads')">
                                       ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÉ‡∏´‡∏°‡πà
                                   </button>
                                   <button class="btn btn-success" onclick="testSync()">
                                       üîÑ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Sync
                                   </button>
                                   <button class="btn btn-info" onclick="openMainPage()">
                                       üëÅÔ∏è ‡∏î‡∏π‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
                                   </button>
                                   <button class="btn btn-warning" onclick="exportData()">
                                       üì§ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                                   </button>
                               </div>
                           </div>
                       </div>
                   </div>
               </div>

               <!-- API Configuration Tab -->
               <div id="tab-api" class="tab-content">
                   <div class="card">
                       <div class="card-header">
                           <h3 class="card-title">üîë IQAir API Configuration</h3>
                       </div>
                       <div class="card-body">
                           <div class="grid grid-cols-1">
                               <div class="form-group">
                                   <label class="form-label" for="apiKey">üóùÔ∏è IQAir API Key</label>
                                   <input type="password" id="apiKey" class="form-input" placeholder="‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà API Key ‡∏à‡∏≤‡∏Å IQAir Dashboard">
                                   <div style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">
                                       üìã ‡∏£‡∏±‡∏ö API Key ‡∏ü‡∏£‡∏µ: <a href="https://dashboard.iqair.com/" target="_blank" style="color: var(--primary-color);">https://dashboard.iqair.com/</a>
                                   </div>
                               </div>

                               <div class="grid grid-cols-3 gap-2">
                                   <div class="form-group">
                                       <label class="form-label" for="city">üèôÔ∏è ‡πÄ‡∏°‡∏∑‡∏≠‡∏á</label>
                                       <input type="text" id="city" class="form-input" placeholder="‡πÄ‡∏ä‡πà‡∏ô Bangkok" value="Bangkok">
                                   </div>
                                   <div class="form-group">
                                       <label class="form-label" for="state">üèõÔ∏è ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î</label>
                                       <input type="text" id="state" class="form-input" placeholder="‡πÄ‡∏ä‡πà‡∏ô Bangkok" value="Bangkok">
                                   </div>
                                   <div class="form-group">
                                       <label class="form-label" for="country">üåç ‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®</label>
                                       <select id="country" class="form-input">
                                           <option value="Thailand">Thailand</option>
                                           <option value="Singapore">Singapore</option>
                                           <option value="Malaysia">Malaysia</option>
                                           <option value="Vietnam">Vietnam</option>
                                           <option value="Philippines">Philippines</option>
                                           <option value="Indonesia">Indonesia</option>
                                       </select>
                                   </div>
                               </div>

                               <div class="flex gap-2">
                                   <button class="btn btn-primary" onclick="testApi()">
                                       üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠
                                   </button>
                                   <button class="btn btn-success" onclick="saveApiConfig()">
                                       üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                                   </button>
                                   <button class="btn btn-secondary" onclick="toggleApiKeyVisibility()">
                                       üëÅÔ∏è ‡πÅ‡∏™‡∏î‡∏á/‡∏ã‡πà‡∏≠‡∏ô API Key
                                   </button>
                               </div>

                               <div class="alert" id="apiTestResult"></div>
                           </div>
                       </div>
                   </div>
               </div>

               <!-- Advertisement Management Tab -->
               <div id="tab-ads" class="tab-content">
                   <div class="card mb-3">
                       <div class="card-header">
                           <h3 class="card-title">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÉ‡∏´‡∏°‡πà</h3>
                       </div>
                       <div class="card-body">
                           <div class="form-group">
                               <label class="form-label" for="adType">üéØ ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤</label>
                               <select id="adType" class="form-input" onchange="changeAdType()">
                                   <option value="text">üìù ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏° (Rich Text)</option>
                                   <option value="image">üñºÔ∏è ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</option>
                                   <option value="video">üé¨ ‡∏ß‡∏µ‡∏î‡∏µ‡πÇ‡∏≠</option>
                               </select>
                           </div>

                           <!-- Text Form -->
                           <div id="textForm">
                               <div class="form-group">
                                   <label class="form-label">‚úèÔ∏è ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤</label>
                                   
                                   <!-- Quick Insert Buttons -->
                                   <div class="quick-insert">
                                       <button class="quick-btn" onclick="insertQuickText('business')">üè¢ ‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</button>
                                       <button class="quick-btn" onclick="insertQuickText('promotion')">üéâ ‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô</button>
                                       <button class="quick-btn" onclick="insertQuickText('contact')">üìû ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</button>
                                       <button class="quick-btn" onclick="insertQuickText('food')">üçï ‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£</button>
                                       <button class="quick-btn" onclick="insertQuickText('service')">üîß ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</button>
                                       <button class="quick-btn" onclick="insertQuickText('announcement')">üì¢ ‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®</button>
                                   </div>
                                   
                                   <!-- Rich Text Editor -->
                                   <div class="editor-container">
                                       <div id="richEditor"></div>
                                   </div>
                                   
                                   <!-- Background Color Picker -->
                                   <div class="form-group">
                                       <label class="form-label">üé® ‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤</label>
                                       <div class="bg-picker">
                                           <div class="bg-color active" style="background: linear-gradient(45deg, #667eea, #764ba2)" onclick="setAdBackground('linear-gradient(45deg, #667eea, #764ba2)', this)"></div>
                                           <div class="bg-color" style="background: linear-gradient(45deg, #11998e, #38ef7d)" onclick="setAdBackground('linear-gradient(45deg, #11998e, #38ef7d)', this)"></div>
                                           <div class="bg-color" style="background: linear-gradient(45deg, #f093fb, #f5576c)" onclick="setAdBackground('linear-gradient(45deg, #f093fb, #f5576c)', this)"></div>
                                           <div class="bg-color" style="background: linear-gradient(45deg, #ff6b6b, #4ecdc4)" onclick="setAdBackground('linear-gradient(45deg, #ff6b6b, #4ecdc4)', this)"></div>
                                           <div class="bg-color" style="background: linear-gradient(45deg, #a8edea, #fed6e3)" onclick="setAdBackground('linear-gradient(45deg, #a8edea, #fed6e3)', this)"></div>
                                           <div class="bg-color" style="background: linear-gradient(45deg, #ffecd2, #fcb69f)" onclick="setAdBackground('linear-gradient(45deg, #ffecd2, #fcb69f)', this)"></div>
                                           <div class="bg-color" style="background: linear-gradient(45deg, #ff512f, #dd2476)" onclick="setAdBackground('linear-gradient(45deg, #ff512f, #dd2476)', this)"></div>
                                           <div class="bg-color" style="background: linear-gradient(45deg, #1e1e1e, #434343)" onclick="setAdBackground('linear-gradient(45deg, #1e1e1e, #434343)', this)"></div>
                                       </div>
                                   </div>
                               </div>
                           </div>

                           <!-- File Form -->
                           <div id="fileForm" class="hidden">
                               <div class="form-group">
                                   <label class="form-label" for="adFile">üìÅ ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå</label>
                                   <input type="file" id="adFile" class="form-input" accept="image/*,video/*" onchange="previewFile()">
                                   <div style="background: #eff6ff; border: 1px solid #93c5fd; border-radius: 8px; padding: 1rem; margin-top: 0.5rem; font-size: 0.875rem; color: #1e40af;">
                                       üìè <strong>‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î: 50MB</strong><br>
                                       üñºÔ∏è ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û: JPG, PNG, GIF, WebP<br>
                                       üé¨ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏ß‡∏µ‡∏î‡∏µ‡πÇ‡∏≠: MP4, WebM, MOV
                                   </div>
                                   <div id="filePreview" class="mt-2"></div>
                               </div>
                           </div>

                           <div class="form-group">
                               <label class="form-label" for="adDuration">‚è±Ô∏è ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏™‡∏î‡∏á (‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)</label>
                               <input type="number" id="adDuration" class="form-input" value="15" min="5" max="300">
                               <div style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">
                                   ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: 15-30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏¥‡∏ü‡∏ó‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏≤‡∏ô‡πå‡πÄ‡∏ï‡∏≠‡∏£‡πå
                               </div>
                           </div>

                           <div class="flex gap-2">
                               <button class="btn btn-primary" onclick="addNewAd()">
                                   ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤
                               </button>
                               <button class="btn btn-warning" onclick="addSampleAd()">
                                   üß™ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
                               </button>
                               <button class="btn btn-info" onclick="previewCurrentAd()">
                                   üëÅÔ∏è ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á
                               </button>
                               <button class="btn btn-secondary" onclick="resetAdForm()">
                                   üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°
                               </button>
                           </div>
                       </div>
                   </div>

                   <!-- Sample Gallery -->
                   <div class="card mb-3">
                       <div class="card-header">
                           <h3 class="card-title">üé® ‡πÄ‡∏ó‡πá‡∏°‡πÄ‡∏û‡∏•‡∏ï‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏£‡∏π‡∏õ</h3>
                       </div>
                       <div class="card-body">
                           <div class="sample-gallery">
                               <div class="sample-item" style="background: linear-gradient(45deg, #11998e, #38ef7d)" onclick="useSampleTemplate('business')">
                                   <div>
                                       <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üè¢</div>
                                       <div><strong>‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à</strong></div>
                                       <div style="font-size: 0.875rem; opacity: 0.9;">‡∏ä‡∏∑‡πà‡∏≠‡∏£‡πâ‡∏≤‡∏ô + ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</div>
                                   </div>
                               </div>
                               <div class="sample-item" style="background: linear-gradient(45deg, #f093fb, #f5576c)" onclick="useSampleTemplate('promotion')">
                                   <div>
                                       <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üéâ</div>
                                       <div><strong>‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô</strong></div>
                                       <div style="font-size: 0.875rem; opacity: 0.9;">‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤ + ‡∏à‡∏≥‡∏Å‡∏±‡∏î‡πÄ‡∏ß‡∏•‡∏≤</div>
                                   </div>
                               </div>
                               <div class="sample-item" style="background: linear-gradient(45deg, #667eea, #764ba2)" onclick="useSampleTemplate('announcement')">
                                   <div>
                                       <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üì¢</div>
                                       <div><strong>‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®</strong></div>
                                       <div style="font-size: 0.875rem; opacity: 0.9;">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</div>
                                   </div>
                               </div>
                               <div class="sample-item" style="background: linear-gradient(45deg, #ff6b6b, #4ecdc4)" onclick="useSampleTemplate('food')">
                                   <div>
                                       <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üçï</div>
                                       <div><strong>‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£</strong></div>
                                       <div style="font-size: 0.875rem; opacity: 0.9;">‡πÄ‡∏°‡∏ô‡∏π + ‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏õ‡∏¥‡∏î</div>
                                   </div>
                               </div>
                               <div class="sample-item" style="background: linear-gradient(45deg, #a8edea, #fed6e3)" onclick="useSampleTemplate('service')">
                                   <div>
                                       <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üîß</div>
                                       <div><strong>‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£</strong></div>
                                       <div style="font-size: 0.875rem; opacity: 0.9;">‡∏ã‡πà‡∏≠‡∏°‡πÅ‡∏ã‡∏° + ‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á</div>
                                   </div>
                               </div>
                               <div class="sample-item" style="background: linear-gradient(45deg, #ffecd2, #fcb69f)" onclick="useSampleTemplate('contact')">
                                   <div>
                                       <div style="font-size: 1.5rem; margin-bottom: 0.5rem;">üìû</div>
                                       <div><strong>‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠</strong></div>
                                       <div style="font-size: 0.875rem; opacity: 0.9;">‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏ï‡πà‡∏≤‡∏á‡πÜ</div>
                                   </div>
                               </div>
                           </div>
                       </div>
                   </div>

                   <!-- Advertisement List -->
                   <div class="card">
                       <div class="card-header flex justify-between items-center">
                           <h3 class="card-title">üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ (<span id="adCount">0</span> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£)</h3>
                           <div class="flex gap-2">
                               <button class="btn btn-success" onclick="exportAds()">üì§ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å</button>
                               <button class="btn btn-info" onclick="importAds()">üì• ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤</button>
                               <button class="btn btn-warning" onclick="testSync()">üîÑ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö Sync</button>
                               <button class="btn btn-error" onclick="clearAllAds()">üóëÔ∏è ‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                           </div>
                       </div>
                       <div class="card-body">
                           <div class="ad-grid" id="adGrid">
                               <!-- Advertisement items will be rendered here -->
                           </div>
                       </div>
                   </div>
               </div>

               <!-- Preview Tab -->
               <div id="tab-preview" class="tab-content">
                   <div class="card">
                       <div class="card-header">
                           <h3 class="card-title">üëÅÔ∏è ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</h3>
                       </div>
                       <div class="card-body">
                           <div class="preview-container">
                               <div class="preview-display" id="previewDisplay">
                                   <div class="preview-text">
                                       üåü ‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö<br>
                                       üìä Digital Signage Pro v3.0<br>
                                       ‚ö° ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå
                                   </div>
                               </div>
                               <div class="preview-controls">
                                   <button class="btn btn-secondary" onclick="prevPreview()">‚óÄÔ∏è ‡∏Å‡πà‡∏≠‡∏ô‡∏´‡∏ô‡πâ‡∏≤</button>
                                   <span class="preview-counter" id="previewCounter">1/3</span>
                                   <button class="btn btn-secondary" onclick="nextPreview()">‚ñ∂Ô∏è ‡∏ñ‡∏±‡∏î‡πÑ‡∏õ</button>
                               </div>
                           </div>
                       </div>
                   </div>

                   <div class="card">
                       <div class="card-header">
                           <h3 class="card-title">üöÄ ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏à‡∏£‡∏¥‡∏á</h3>
                       </div>
                       <div class="card-body">
                           <div class="flex gap-2">
                               <button class="btn btn-primary" onclick="openMainPage()">üñ•Ô∏è ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô‡πÅ‡∏ó‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà</button>
                               <button class="btn btn-info" onclick="openMainPageFullscreen()">üì∫ ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ö‡∏ö‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠</button>
                               <button class="btn btn-secondary" onclick="copyMainPageUrl()">üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å URL</button>
                           </div>
                           
                           <div style="background: #fffbeb; border: 1px solid #fde68a; border-radius: 12px; padding: 1.5rem; margin-top: 1.5rem;">
                               <h4 style="color: #92400e; margin-bottom: 1rem;">üì± ‡∏Ñ‡∏≥‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</h4>
                               <ul style="margin-left: 1.5rem; line-height: 1.8; color: #92400e;">
                                   <li><strong>üñ•Ô∏è ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô‡πÅ‡∏ó‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà:</strong> ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</li>
                                   <li><strong>üì∫ ‡πÄ‡∏õ‡∏¥‡∏î‡πÅ‡∏ö‡∏ö‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠:</strong> ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•‡∏à‡∏£‡∏¥‡∏á</li>
                                   <li><strong>üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å URL:</strong> ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡πà‡∏á‡πÉ‡∏´‡πâ‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô</li>
                                   <li><strong>üéÆ Remote Control:</strong> ‚Üê ‚Üí ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ | Enter ‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä | Space ‡∏´‡∏¢‡∏∏‡∏î</li>
                                   <li><strong>üì± Layout:</strong> 1=‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô | 2=‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á | 3-9=‡∏ò‡∏µ‡∏°‡∏™‡∏µ</li>
                               </ul>
                           </div>
                       </div>
                   </div>
               </div>

               <!-- Cloud Sync Tab -->
               <div id="tab-sync" class="tab-content">
                   <div class="card">
                       <div class="card-header">
                           <h3 class="card-title">‚òÅÔ∏è Google Sheets Integration</h3>
                       </div>
                       <div class="card-body">
                           <div class="form-group">
                               <label class="form-label" for="sheetsUrl">üìÑ Google Sheets URL</label>
                               <input type="url" id="sheetsUrl" class="form-input" placeholder="https://docs.google.com/spreadsheets/d/...">
                               <div style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">
                                   ‡πÉ‡∏™‡πà URL ‡∏Ç‡∏≠‡∏á Google Sheets ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ sync ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
                               </div>
                           </div>

                           <div style="background: #f3f4f6; padding: 1.5rem; border-radius: 12px; margin: 1rem 0;">
                               <h4 style="margin-bottom: 1rem;">üìã ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô Google Sheets</h4>
                               <div style="font-family: monospace; font-size: 0.875rem;">
                                   <strong>Columns:</strong><br>
                                   A: Title (‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤)<br>
                                   B: Content (‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤ - ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö HTML)<br>
                                   C: Color (‡∏™‡∏µ: blue, green, pink, orange, purple, yellow, red, dark)<br>
                                   D: Duration (‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤ ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)<br>
                               </div>
                           </div>

                           <div class="flex gap-2">
                               <button class="btn btn-primary" onclick="setupGoogleSheets()">üîó ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Google Sheets</button>
                               <button class="btn btn-success" onclick="syncFromSheets()">üîÑ Sync ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Sheets</button>
                               <button class="btn btn-warning" onclick="testGoogleSheets()">üß™ ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠</button>
                           </div>

                           <div class="alert" id="sheetsStatus"></div>
                       </div>
                   </div>

                   <div class="card">
                       <div class="card-header">
                           <h3 class="card-title">üåê Cloud Storage Sync</h3>
                       </div>
                       <div class="card-body">
                           <div class="form-group">
                               <label class="form-label" for="cloudUrl">‚òÅÔ∏è Cloud Storage URL</label>
                               <input type="url" id="cloudUrl" class="form-input" placeholder="https://your-cloud-api.com/sync">
                               <div style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">
                                   ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Firebase, Supabase ‡∏´‡∏£‡∏∑‡∏≠ API ‡∏≠‡∏∑‡πà‡∏ô‡πÜ
                               </div>
                           </div>

                           <div class="flex gap-2">
                               <button class="btn btn-primary" onclick="setupCloudSync()">üîó ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ Cloud</button>
                               <button class="btn btn-success" onclick="syncToCloud()">‚òÅÔ∏è Sync ‡πÑ‡∏õ Cloud</button>
                               <button class="btn btn-info" onclick="syncFromCloud()">üì• Sync ‡∏à‡∏≤‡∏Å Cloud</button>
                           </div>

                           <div class="alert" id="cloudStatus"></div>
                       </div>
                   </div>
               </div>

               <!-- Settings Tab -->
               <div id="tab-settings" class="tab-content">
                   <div class="card">
                       <div class="card-header">
                           <h3 class="card-title">‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h3>
                       </div>
                       <div class="card-body">
                           <div class="grid grid-cols-2">
                               <div class="form-group">
                                   <label class="form-label" for="updateInterval">üïê ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó AQI (‡∏ô‡∏≤‡∏ó‡∏µ)</label>
                                   <input type="number" id="updateInterval" class="form-input" value="10" min="1" max="60">
                                   <div style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">
                                       ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: 10-15 ‡∏ô‡∏≤‡∏ó‡∏µ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡∏£‡∏∞‡∏´‡∏¢‡∏±‡∏î API calls
                                   </div>
                               </div>
                               <div class="form-group">
                                   <label class="form-label" for="adInterval">üîÑ ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ (‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ)</label>
                                   <input type="number" id="adInterval" class="form-input" value="15" min="5" max="120">
                                   <div style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">
                                       ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥: 15-30 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏•‡∏¥‡∏ü‡∏ó‡πå‡πÅ‡∏•‡∏∞‡πÄ‡∏Ñ‡∏≤‡∏ô‡πå‡πÄ‡∏ï‡∏≠‡∏£‡πå
                                   </div>
                               </div>
                           </div>

                           <div class="form-group">
                               <label class="form-label" for="maxFileSize">üìÅ ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î (MB)</label>
                               <select id="maxFileSize" class="form-input">
                                   <option value="10">10 MB - ‡πÄ‡∏ö‡∏∑‡πâ‡∏≠‡∏á‡∏ï‡πâ‡∏ô</option>
                                   <option value="25">25 MB - ‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
                                   <option value="50" selected>50 MB - ‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</option>
                                   <option value="100">100 MB - ‡∏™‡∏π‡∏á (‡∏≠‡∏≤‡∏à‡∏ä‡πâ‡∏≤)</option>
                               </select>
                               <div style="font-size: 0.875rem; color: var(--text-secondary); margin-top: 0.5rem;">
                                ‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏´‡∏ç‡πà = ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏™‡∏π‡∏á ‡πÅ‡∏ï‡πà‡∏≠‡∏≤‡∏à‡πÇ‡∏´‡∏•‡∏î‡∏ä‡πâ‡∏≤‡πÉ‡∏ô‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå‡∏ö‡∏≤‡∏á‡∏£‡∏∏‡πà‡∏ô
                            </div>
                        </div>

                        <button class="btn btn-success" onclick="saveSystemSettings()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h3 class="card-title">üíæ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                    </div>
                    <div class="card-body">
                        <div class="flex gap-2 mb-3">
                            <button class="btn btn-success" onclick="exportAllData()">üì§ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                            <button class="btn btn-info" onclick="importAllData()">üì• ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                            <button class="btn btn-warning" onclick="resetAllSettings()">üîÑ ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï</button>
                            <button class="btn btn-error" onclick="clearAllData()">üóëÔ∏è ‡∏•‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
                            <input type="file" id="importFile" accept=".json" style="display: none;" onchange="handleImportFile(event)">
                        </div>

                        <div style="background: #ecfdf5; border: 1px solid #a7f3d0; border-radius: 12px; padding: 1.5rem;">
                            <h4 style="color: #065f46; margin-bottom: 1rem;">‚ÑπÔ∏è ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏∞‡∏ö‡∏ö</h4>
                            <div class="grid grid-cols-2 gap-2" style="color: #065f46;">
                                <div><strong>üì± ‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô:</strong> v3.0</div>
                                <div><strong>üõ†Ô∏è ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠:</strong> 7 ‡∏°‡∏¥.‡∏¢. 2568</div>
                                <div><strong>üéØ ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö:</strong> ‡∏•‡∏¥‡∏ü‡∏ó‡πå & ‡πÄ‡∏Ñ‡∏≤‡∏ô‡πå‡πÄ‡∏ï‡∏≠‡∏£‡πå</div>
                                <div><strong>üì∫ ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö:</strong> Samsung TV</div>
                                <div><strong>üåê API:</strong> IQAir Real-time</div>
                                <div><strong>‚òÅÔ∏è Sync:</strong> Google Sheets + Cloud</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>

<!-- JavaScript -->
<script>
    // === GLOBAL VARIABLES ===
    let isLoggedIn = false;
    let advertisements = [];
    let currentPreviewIndex = 0;
    let richEditor = null;
    let currentAdBackground = 'linear-gradient(45deg, #667eea, #764ba2)';
    let syncCounter = 0;
    
    const ADMIN_USER = 'admin';
    const ADMIN_PASS = 'vipart2025';
    const MAX_FILE_SIZE = 50 * 1024 * 1024; // 50MB

    // Quick text templates
    const quickTextTemplates = {
        business: 'üè¢ <strong>‡∏ä‡∏∑‡πà‡∏≠‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</strong><br><br>üìû <strong>‡πÇ‡∏ó‡∏£:</strong> 02-xxx-xxxx<br><br>üè™ <strong>‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á:</strong> ‡∏ä‡∏±‡πâ‡∏ô G<br><br>‚è∞ <strong>‡πÄ‡∏õ‡∏¥‡∏î:</strong> 08:00 - 20:00',
        promotion: 'üéâ <strong>‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©!</strong><br><br>üí∞ <strong>‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤ 50%</strong><br><br>üõçÔ∏è ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏£‡∏£<br><br>‚è∞ <strong>‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î:</strong> 31 ‡∏ò.‡∏Ñ. 2568',
        contact: 'üìû <strong>‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</strong><br><br>üë®‚Äçüíº <strong>‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏à‡∏≥</strong><br><br>üìß info@building.com<br><br>üì± <strong>LINE:</strong> @building',
        food: 'üçï <strong>‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏£‡πà‡∏≠‡∏¢</strong><br><br>üçú <strong>‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</strong><br><br>üì± <strong>‡∏™‡∏±‡πà‡∏á‡∏ú‡πà‡∏≤‡∏ô LINE:</strong> @food<br><br>üöö ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ‡πÉ‡∏ô‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£',
        service: 'üîß <strong>‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏≤‡∏á</strong><br><br>‚ö° <strong>‡∏ã‡πà‡∏≠‡∏°‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ ‡∏õ‡∏£‡∏∞‡∏õ‡∏≤</strong><br><br>üìû <strong>‡πÇ‡∏ó‡∏£:</strong> 02-xxx-xxxx<br><br>‚è∞ 08:00 - 18:00 ‡∏ô.',
        announcement: 'üì¢ <strong>‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</strong><br><br>üöß <strong>‡∏õ‡∏¥‡∏î‡∏ã‡πà‡∏≠‡∏°‡∏•‡∏¥‡∏ü‡∏ó‡πå</strong><br><br>üìÖ <strong>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà:</strong> 15-16 ‡∏°‡∏¥.‡∏¢.<br><br>üôè ‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢‡πÉ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏™‡∏∞‡∏î‡∏ß‡∏Å'
    };

    const sampleTemplates = {
        business: {
            content: 'üè¢ <strong>‡∏£‡πâ‡∏≤‡∏ô‡∏™‡∏∞‡∏î‡∏ß‡∏Å‡∏ã‡∏∑‡πâ‡∏≠ 24 ‡∏ä‡∏°.</strong><br><br>üìû <strong>‡πÇ‡∏ó‡∏£:</strong> 02-xxx-xxxx<br><br>üè™ <strong>‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á:</strong> ‡∏ä‡∏±‡πâ‡∏ô G<br><br>‚è∞ ‡πÄ‡∏õ‡∏¥‡∏î‡∏ï‡∏•‡∏≠‡∏î 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á',
            background: 'linear-gradient(45deg, #11998e, #38ef7d)'
        },
        promotion: {
            content: 'üéâ <strong>‡πÇ‡∏õ‡∏£‡πÇ‡∏°‡∏ä‡∏±‡πà‡∏ô‡∏û‡∏¥‡πÄ‡∏®‡∏©!</strong><br><br>üí∞ <strong>‡∏•‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤ 50%</strong><br><br>üõçÔ∏è ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏£‡∏£<br><br>‚è∞ ‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î 31 ‡∏ò.‡∏Ñ. 2568',
            background: 'linear-gradient(45deg, #f093fb, #f5576c)'
        },
        announcement: {
            content: 'üì¢ <strong>‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</strong><br><br>üöß <strong>‡∏õ‡∏¥‡∏î‡∏ã‡πà‡∏≠‡∏°‡∏•‡∏¥‡∏ü‡∏ó‡πå</strong><br><br>üìÖ ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 15-16 ‡∏°‡∏¥.‡∏¢.<br><br>üôè ‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢‡πÉ‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏™‡∏∞‡∏î‡∏ß‡∏Å',
            background: 'linear-gradient(45deg, #667eea, #764ba2)'
        },
        food: {
            content: 'üçï <strong>‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏£‡πà‡∏≠‡∏¢</strong><br><br>üçú <strong>‡πÄ‡∏°‡∏ô‡∏π‡∏û‡∏¥‡πÄ‡∏®‡∏©‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</strong><br><br>üì± ‡∏™‡∏±‡πà‡∏á‡∏ú‡πà‡∏≤‡∏ô LINE: @food<br><br>üöö ‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ‡πÉ‡∏ô‡∏≠‡∏≤‡∏Ñ‡∏≤‡∏£',
            background: 'linear-gradient(45deg, #ff6b6b, #4ecdc4)'
        },
        service: {
            content: 'üîß <strong>‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏ä‡πà‡∏≤‡∏á</strong><br><br>‚ö° <strong>‡∏ã‡πà‡∏≠‡∏°‡πÑ‡∏ü‡∏ü‡πâ‡∏≤ ‡∏õ‡∏£‡∏∞‡∏õ‡∏≤</strong><br><br>üìû ‡πÇ‡∏ó‡∏£: 02-xxx-xxxx<br><br>‚è∞ 08:00 - 18:00 ‡∏ô.',
            background: 'linear-gradient(45deg, #a8edea, #fed6e3)'
        },
        contact: {
            content: 'üìû <strong>‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</strong><br><br>üë®‚Äçüíº <strong>‡πÄ‡∏à‡πâ‡∏≤‡∏´‡∏ô‡πâ‡∏≤‡∏ó‡∏µ‡πà‡∏õ‡∏£‡∏∞‡∏à‡∏≥</strong><br><br>üìß info@building.com<br><br>üì± LINE: @building',
            background: 'linear-gradient(45deg, #ffecd2, #fcb69f)'
        }
    };

    // === INITIALIZATION ===
    document.addEventListener('DOMContentLoaded', function() {
        console.log('üöÄ Digital Signage Pro v3.0 Admin Panel ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô');
        checkLogin();
        setupEventListeners();
    });

    function checkLogin() {
        try {
            const savedLogin = localStorage.getItem('vipart_admin_login');
            const loginTime = localStorage.getItem('vipart_login_time');
            
            if (savedLogin === 'true' && loginTime) {
                const sessionTime = 24 * 60 * 60 * 1000; // 24 ‡∏ä‡∏±‡πà‡∏ß‡πÇ‡∏°‡∏á
                if (Date.now() - parseInt(loginTime) < sessionTime) {
                    isLoggedIn = true;
                    showAdminPanel();
                    initSystem();
                    return;
                }
            }
            showLoginForm();
        } catch (error) {
            console.error('‚ùå Check login error:', error);
            showLoginForm();
        }
    }

    function setupEventListeners() {
        // Login form submit
        document.getElementById('loginForm').addEventListener('submit', handleLogin);
        
        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 's':
                        e.preventDefault();
                        saveCurrentTab();
                        break;
                    case 'r':
                        e.preventDefault();
                        testSync();
                        break;
                    case 'p':
                        e.preventDefault();
                        openMainPage();
                        break;
                }
            }
        });
    }

    // === LOGIN SYSTEM ===
    function handleLogin(event) {
        event.preventDefault();
        
        const username = document.getElementById('username').value.trim();
        const password = document.getElementById('password').value.trim();
        
        if (username === ADMIN_USER && password === ADMIN_PASS) {
            isLoggedIn = true;
            localStorage.setItem('vipart_admin_login', 'true');
            localStorage.setItem('vipart_login_time', Date.now().toString());
            
            showAdminPanel();
            initSystem();
            showAlert('success', 'üéâ ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
        } else {
            showAlert('error', '‚ùå ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
        }
    }

    function handleLogout() {
        if (confirm('‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
            isLoggedIn = false;
            localStorage.removeItem('vipart_admin_login');
            localStorage.removeItem('vipart_login_time');
            showLoginForm();
            showAlert('success', 'üëã ‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
        }
    }

    function showLoginForm() {
        document.getElementById('loginContainer').style.display = 'flex';
        document.getElementById('adminLayout').classList.remove('show');
    }

    function showAdminPanel() {
        document.getElementById('loginContainer').style.display = 'none';
        document.getElementById('adminLayout').classList.add('show');
    }

    // === SYSTEM INITIALIZATION ===
    function initSystem() {
        console.log('üéØ ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö Admin Panel v3.0');
        
        loadSettings();
        loadAdvertisements();
        initRichTextEditor();
        updateDashboard();
        updatePreview();
        
        console.log('‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
        updateStatusIndicator('success', '‚úÖ ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°');
    }

    function loadSettings() {
        try {
            const settings = JSON.parse(localStorage.getItem('vipart_settings') || '{}');
            const location = JSON.parse(localStorage.getItem('vipart_location') || '{}');
            
            // Load API settings
            if (settings.apiKey) {
                document.getElementById('apiKey').value = settings.apiKey;
            }
            if (location.city) {
                document.getElementById('city').value = location.city;
                document.getElementById('state').value = location.state || '';
                document.getElementById('country').value = location.country || 'Thailand';
            }
            
            // Load system settings
            if (settings.updateInterval) {
                document.getElementById('updateInterval').value = settings.updateInterval;
            }
            if (settings.adInterval) {
                document.getElementById('adInterval').value = settings.adInterval;
            }
            
            console.log('‚öôÔ∏è ‡πÇ‡∏´‡∏•‡∏î‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
        } catch (error) {
            console.error('‚ùå Load settings error:', error);
        }
    }

    function loadAdvertisements() {
        try {
            const stored = localStorage.getItem('vipart_advertisements');
            advertisements = stored ? JSON.parse(stored) : getDefaultAds();
            
            if (advertisements.length === 0) {
                advertisements = getDefaultAds();
                saveAdvertisements();
            }
            
            renderAdList();
            console.log('üì¢ ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤:', advertisements.length, '‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
        } catch (error) {
            console.error('‚ùå Load ads error:', error);
            advertisements = getDefaultAds();
            saveAdvertisements();
            renderAdList();
        }
    }

    function getDefaultAds() {
        const now = Date.now();
        return [
            {
                type: 'text',
                content: 'üåü <strong>‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</strong><br><br>üìä Digital Signage Pro v3.0<br><br>‚ö° ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡πÅ‡∏ö‡∏ö‡πÄ‡∏£‡∏µ‡∏¢‡∏•‡πÑ‡∏ó‡∏°‡πå<br><br>üéØ Admin Panel ‡πÉ‡∏´‡∏°‡πà',
                background: 'linear-gradient(45deg, #667eea, #764ba2)',
                duration: 20000,
                id: now + 1
            },
            {
                type: 'text',
                content: 'üè¢ <strong>‡∏ä‡∏∑‡πà‡∏≠‡∏ò‡∏∏‡∏£‡∏Å‡∏¥‡∏à‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</strong><br><br>üìû <strong>‡πÇ‡∏ó‡∏£:</strong> 02-xxx-xxxx<br><br>üåü ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡∏¢‡∏°<br><br>üíé ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô 999 ‡∏ö‡∏≤‡∏ó',
                background: 'linear-gradient(45deg, #11998e, #38ef7d)',
                duration: 18000,
                id: now + 2
            },
            {
                type: 'text',
                content: 'üçï <strong>‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£ ‡∏ä‡∏±‡πâ‡∏ô G</strong><br><br>‚è∞ <strong>‡πÄ‡∏õ‡∏¥‡∏î:</strong> 08:00 - 22:00<br><br>üéâ ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î 20% ‡∏ó‡∏∏‡∏Å‡∏ß‡∏±‡∏ô‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå<br><br>üì± ‡∏™‡∏±‡πà‡∏á‡∏ú‡πà‡∏≤‡∏ô Food Delivery',
                background: 'linear-gradient(45deg, #f093fb, #f5576c)',
                duration: 16000,
                id: now + 3
            }
        ];
    }

    // === RICH TEXT EDITOR ===
    function initRichTextEditor() {
        try {
            const toolbarOptions = [
                ['bold', 'italic', 'underline', 'strike'],
                ['blockquote', 'code-block'],
                [{ 'header': 1 }, { 'header': 2 }],
                [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                [{ 'script': 'sub'}, { 'script': 'super' }],
                [{ 'indent': '-1'}, { 'indent': '+1' }],
                [{ 'size': ['small', false, 'large', 'huge'] }],
                [{ 'color': [] }, { 'background': [] }],
                [{ 'align': [] }],
                ['clean']
            ];

            richEditor = new Quill('#richEditor', {
                theme: 'snow',
                modules: {
                    toolbar: toolbarOptions
                },
                placeholder: '‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà...\n\nüí° ‡πÄ‡∏Ñ‡∏•‡πá‡∏î‡∏•‡∏±‡∏ö:\n- ‡πÉ‡∏ä‡πâ‡∏õ‡∏∏‡πà‡∏° Quick Insert ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ó‡πá‡∏°‡πÄ‡∏û‡∏•‡∏ï‡πÄ‡∏£‡πá‡∏ß\n- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á\n- ‡πÉ‡∏™‡πà‡∏≠‡∏µ‡πÇ‡∏°‡∏à‡∏¥ üòä ‡πÉ‡∏´‡πâ‡∏ô‡πà‡∏≤‡∏™‡∏ô‡πÉ‡∏à'
            });

            // Auto-save draft
            richEditor.on('text-change', function() {
                try {
                    localStorage.setItem('vipart_draft_content', richEditor.root.innerHTML);
                } catch (e) {
                    console.warn('‚ö†Ô∏è Auto-save ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                }
            });

            // Load draft
            try {
                const draftContent = localStorage.getItem('vipart_draft_content');
                if (draftContent) {
                    richEditor.root.innerHTML = draftContent;
                }
            } catch (e) {
                console.warn('‚ö†Ô∏è ‡πÇ‡∏´‡∏•‡∏î draft ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
            }

            console.log('‚úÖ Rich Text Editor ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
        } catch (error) {
            console.error('‚ùå Rich Text Editor init error:', error);
            showAlert('error', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î Rich Text Editor ‡πÑ‡∏î‡πâ');
        }
    }

    // === TAB SYSTEM ===
    function switchTab(tabName) {
        try {
            // Update sidebar navigation
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            document.querySelector(`[data-tab="${tabName}"]`).classList.add('active');

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`tab-${tabName}`).classList.add('active');

            // Update page title
            const titles = {
                dashboard: 'üìä ‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î',
                api: 'üîë API Configuration',
                ads: 'üì¢ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤',
                preview: 'üëÅÔ∏è ‡∏î‡∏π‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á',
                sync: '‚òÅÔ∏è Cloud Sync',
                settings: '‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤'
            };
            document.getElementById('pageTitle').textContent = titles[tabName] || 'Admin Panel';

            // Tab-specific actions
            if (tabName === 'ads') {
                renderAdList();
            } else if (tabName === 'preview') {
                updatePreview();
            } else if (tabName === 'dashboard') {
                updateDashboard();
            }

            console.log('üìÇ ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÑ‡∏õ‡πÅ‡∏ó‡πá‡∏ö:', tabName);
        } catch (error) {
            console.error('‚ùå Switch tab error:', error);
        }
    }

    // === ADVERTISEMENT MANAGEMENT ===
    function changeAdType() {
        const type = document.getElementById('adType').value;
        document.getElementById('textForm').classList.toggle('hidden', type !== 'text');
        document.getElementById('fileForm').classList.toggle('hidden', type === 'text');
        
        const fileInput = document.getElementById('adFile');
        if (type === 'image') {
            fileInput.accept = 'image/*';
        } else if (type === 'video') {
            fileInput.accept = 'video/*';
        }
    }

    function insertQuickText(type) {
        if (!richEditor || !quickTextTemplates[type]) return;
        
        try {
            const template = quickTextTemplates[type];
            const range = richEditor.getSelection();
            const index = range ? range.index : richEditor.getLength();
            
            richEditor.clipboard.dangerouslyPasteHTML(index, template);
            showAlert('success', `‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ó‡πá‡∏°‡πÄ‡∏û‡∏•‡∏ï "${type}" ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!`);
        } catch (error) {
            console.error('‚ùå Insert quick text error:', error);
            showAlert('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ó‡πá‡∏°‡πÄ‡∏û‡∏•‡∏ï');
        }
    }

    function setAdBackground(gradient, element) {
        currentAdBackground = gradient;
        
        document.querySelectorAll('.bg-color').forEach(el => el.classList.remove('active'));
        element.classList.add('active');
        
        console.log('üé® ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á:', gradient);
    }

    function useSampleTemplate(type) {
        const template = sampleTemplates[type];
        if (template && richEditor) {
            richEditor.root.innerHTML = template.content;
            currentAdBackground = template.background;
            
            // Update background picker
            document.querySelectorAll('.bg-color').forEach(el => {
                el.classList.remove('active');
                if (el.style.background === template.background) {
                    el.classList.add('active');
                }
            });
            
            showAlert('success', `‚úÖ ‡πÉ‡∏ä‡πâ‡πÄ‡∏ó‡πá‡∏°‡πÄ‡∏û‡∏•‡∏ï "${type}" ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!`);
            switchTab('ads');
        }
    }

    function previewFile() {
        try {
            const fileInput = document.getElementById('adFile');
            const preview = document.getElementById('filePreview');
            const file = fileInput.files[0];
            
            if (file) {
                if (file.size > MAX_FILE_SIZE) {
                    const maxSizeMB = Math.round(MAX_FILE_SIZE / (1024 * 1024));
                    showAlert('error', `‡πÑ‡∏ü‡∏•‡πå‡∏°‡∏µ‡∏Ç‡∏ô‡∏≤‡∏î‡πÉ‡∏´‡∏ç‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ (‡∏à‡∏≥‡∏Å‡∏±‡∏î ${maxSizeMB}MB)`);
                    fileInput.value = '';
                    preview.innerHTML = '';
                    return;
                }
                
                const reader = new FileReader();
                reader.onload = function(e) {
                    const fileSizeMB = (file.size / (1024 * 1024)).toFixed(1);
                    
                    if (file.type.startsWith('image/')) {
                        preview.innerHTML = `
                            <img src="${e.target.result}" style="max-width: 200px; max-height: 150px; margin-top: 10px; border-radius: 10px;" alt="Preview">
                            <div style="margin-top: 10px; font-size: 0.875rem; color: var(--text-secondary);">
                                üìÅ ${file.name}<br>
                                üìè ${fileSizeMB} MB
                            </div>
                        `;
                    } else if (file.type.startsWith('video/')) {
                        preview.innerHTML = `
                            <video src="${e.target.result}" style="max-width: 200px; max-height: 150px; margin-top: 10px; border-radius: 10px;" controls muted preload="metadata"></video>
                            <div style="margin-top: 10px; font-size: 0.875rem; color: var(--text-secondary);">
                                üìÅ ${file.name}<br>
                                üìè ${fileSizeMB} MB
                            </div>
                        `;
                    }
                };
                reader.readAsDataURL(file);
            } else {
                preview.innerHTML = '';
            }
        } catch (error) {
            console.error('‚ùå Preview file error:', error);
        }
    }

    function addNewAd() {
        try {
            const type = document.getElementById('adType').value;
            const duration = parseInt(document.getElementById('adDuration').value) * 1000;
            
            if (!duration || duration < 5000) {
                showAlert('error', '‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ 5 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ');
                return;
            }
            
            let adData = {
                type,
                duration,
                id: Date.now()
            };
            
            if (type === 'text') {
                if (!richEditor) {
                    showAlert('error', 'Rich Text Editor ‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô');
                    return;
                }
                
                const content = richEditor.root.innerHTML;
                if (!content.trim() || content === '<p><br></p>') {
                    showAlert('error', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤');
                    return;
                }
                
                adData.content = content;
                adData.background = currentAdBackground;
                
                advertisements.push(adData);
                saveAdvertisements();
                resetAdForm();
                renderAdList();
                updateDashboard();
                updatePreview();
                notifyMainPage();
                showAlert('success', '‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                
            } else {
                const fileInput = document.getElementById('adFile');
                
                if (!fileInput.files[0]) {
                    showAlert('error', `‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å${type === 'image' ? '‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û' : '‡∏ß‡∏µ‡∏î‡∏µ‡πÇ‡∏≠'}`);
                    return;
                }
                
                const file = fileInput.files[0];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    adData.src = e.target.result;
                    adData.fileName = file.name;
                    adData.fileSize = Math.round(file.size / 1024) + ' KB';
                    
                    advertisements.push(adData);
                    saveAdvertisements();
                    resetAdForm();
                    renderAdList();
                    updateDashboard();
                    updatePreview();
                    notifyMainPage();
                    showAlert('success', `‚úÖ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤${type === 'image' ? '‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û' : '‡∏ß‡∏µ‡∏î‡∏µ‡πÇ‡∏≠'}‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!`);
                };
                
                reader.readAsDataURL(file);
            }
        } catch (error) {
            console.error('‚ùå Add ad error:', error);
            showAlert('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤');
        }
    }

    function addSampleAd() {
        const sampleAd = {
            type: 'text',
            content: `üß™ <strong>‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏ó‡∏î‡∏™‡∏≠‡∏ö v3.0</strong><br><br>üìÖ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠: ${new Date().toLocaleString('th-TH')}<br><br>‚ú® <strong>‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!</strong><br><br>üéØ ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏à‡∏£‡∏¥‡∏á<br><br>üîÑ Sync Counter: ${syncCounter + 1}`,
            background: 'linear-gradient(45deg, #e74c3c, #f39c12)',
            duration: 15000,
            id: Date.now()
        };
        
        advertisements.push(sampleAd);
        saveAdvertisements();
        renderAdList();
        updateDashboard();
        updatePreview();
        notifyMainPage();
        showAlert('success', 'üß™ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
    }

    function resetAdForm() {
        try {
            if (richEditor) {
                richEditor.setContents([]);
            }
            document.getElementById('adFile').value = '';
            document.getElementById('adDuration').value = '15';
            document.getElementById('filePreview').innerHTML = '';
            document.getElementById('adType').value = 'text';
            changeAdType();
            
            currentAdBackground = 'linear-gradient(45deg, #667eea, #764ba2)';
            document.querySelectorAll('.bg-color').forEach(el => el.classList.remove('active'));
            document.querySelector('.bg-color').classList.add('active');
            
            try {
                localStorage.removeItem('vipart_draft_content');
            } catch (e) {
                console.warn('‚ö†Ô∏è ‡∏•‡∏ö draft ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
            }
        } catch (error) {
            console.error('‚ùå Reset form error:', error);
        }
    }

    function renderAdList() {
        try {
            const adGrid = document.getElementById('adGrid');
            const adCount = document.getElementById('adCount');
            
            if (adCount) {
                adCount.textContent = advertisements.length;
            }
            
            if (advertisements.length === 0) {
                adGrid.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; color: var(--text-secondary); padding: 3rem;">
                        <div style="font-size: 3rem; margin-bottom: 1rem;">üì≠</div>
                        <h3 style="margin-bottom: 0.5rem;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤</h3>
                           <p>‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏î‡πâ‡∏ß‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÅ‡∏£‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
                       </div>
                   `;
                   return;
               }
               
               adGrid.innerHTML = advertisements.map((ad, index) => `
                   <div class="ad-item">
                       <div class="ad-preview" style="background: ${ad.background || 'linear-gradient(45deg, #667eea, #764ba2)'};">
                           ${ad.type === 'text' ? `
                               <div style="font-size: 1rem; line-height: 1.4;">${ad.content}</div>
                           ` : ad.type === 'image' ? `
                               <img src="${ad.src}" style="max-width: 100%; max-height: 100%; object-fit: cover;" alt="Ad Preview">
                           ` : `
                               <video src="${ad.src}" style="max-width: 100%; max-height: 100%; object-fit: cover;" muted></video>
                           `}
                       </div>
                       <div class="ad-item-body">
                           <div class="ad-item-title">‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏ó‡∏µ‡πà ${index + 1}</div>
                           <div class="ad-item-meta">
                               ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó: ${getAdTypeLabel(ad.type)} | ‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤: ${ad.duration/1000} ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ
                               ${ad.fileSize ? `| ‡∏Ç‡∏ô‡∏≤‡∏î: ${ad.fileSize}` : ''}
                           </div>
                           <div class="ad-item-actions">
                               <button class="btn btn-info" onclick="previewAd(${index})">üëÅÔ∏è ‡∏î‡∏π</button>
                               <button class="btn btn-warning" onclick="editAd(${index})">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                               <button class="btn btn-success" onclick="duplicateAd(${index})">üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å</button>
                               <button class="btn btn-error" onclick="deleteAd(${index})">üóëÔ∏è ‡∏•‡∏ö</button>
                           </div>
                       </div>
                   </div>
               `).join('');
               
           } catch (error) {
               console.error('‚ùå Render ad list error:', error);
           }
       }

       function getAdTypeLabel(type) {
           switch(type) {
               case 'text': return 'üìù ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°';
               case 'image': return 'üñºÔ∏è ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û';
               case 'video': return 'üé¨ ‡∏ß‡∏µ‡∏î‡∏µ‡πÇ‡∏≠';
               default: return '‚ùì ‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö';
           }
       }

       function previewAd(index) {
           try {
               const ad = advertisements[index];
               if (!ad) return;
               
               currentPreviewIndex = index;
               updatePreview();
               switchTab('preview');
           } catch (error) {
               console.error('‚ùå Preview ad error:', error);
           }
       }

       function editAd(index) {
           try {
               const ad = advertisements[index];
               
               document.getElementById('adType').value = ad.type;
               document.getElementById('adDuration').value = ad.duration / 1000;
               
               changeAdType();
               
               if (ad.type === 'text' && richEditor) {
                   richEditor.root.innerHTML = ad.content;
                   currentAdBackground = ad.background;
                   
                   document.querySelectorAll('.bg-color').forEach(el => el.classList.remove('active'));
                   document.querySelectorAll('.bg-color').forEach(el => {
                       if (el.style.background === ad.background) {
                           el.classList.add('active');
                       }
                   });
               }
               
               advertisements.splice(index, 1);
               saveAdvertisements();
               renderAdList();
               updateDashboard();
               updatePreview();
               notifyMainPage();
               
               showAlert('success', '‚úèÔ∏è ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÅ‡∏•‡πâ‡∏ß ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡∏∞‡∏Å‡∏î "‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤"');
               switchTab('ads');
               
           } catch (error) {
               console.error('‚ùå Edit ad error:', error);
           }
       }

       function duplicateAd(index) {
           try {
               const originalAd = advertisements[index];
               const duplicatedAd = {
                   ...originalAd,
                   id: Date.now(),
                   content: originalAd.content ? originalAd.content.replace('</strong>', ' (‡∏™‡∏≥‡πÄ‡∏ô‡∏≤)</strong>') : originalAd.content
               };
               
               advertisements.push(duplicatedAd);
               saveAdvertisements();
               renderAdList();
               updateDashboard();
               updatePreview();
               notifyMainPage();
               showAlert('success', 'üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
           } catch (error) {
               console.error('‚ùå Duplicate ad error:', error);
           }
       }

       function deleteAd(index) {
           try {
               if (confirm('üóëÔ∏è ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                   advertisements.splice(index, 1);
                   saveAdvertisements();
                   renderAdList();
                   updateDashboard();
                   updatePreview();
                   notifyMainPage();
                   showAlert('success', 'üóëÔ∏è ‡∏•‡∏ö‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');
               }
           } catch (error) {
               console.error('‚ùå Delete ad error:', error);
           }
       }

       function saveAdvertisements() {
           try {
               localStorage.setItem('vipart_advertisements', JSON.stringify(advertisements));
               setTimeout(() => {
                   notifyMainPage();
               }, 100);
               return true;
           } catch (error) {
               console.error('‚ùå Save ads error:', error);
               showAlert('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤');
               return false;
           }
       }

       // === PREVIEW SYSTEM ===
       function updatePreview() {
           try {
               if (advertisements.length === 0) {
                   document.getElementById('previewDisplay').innerHTML = 
                       '<div class="preview-text">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤<br>‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÉ‡∏ô‡πÅ‡∏ó‡πá‡∏ö "‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤"</div>';
                   document.getElementById('previewCounter').textContent = '0/0';
                   return;
               }
               
               if (currentPreviewIndex >= advertisements.length) {
                   currentPreviewIndex = 0;
               }
               
               const ad = advertisements[currentPreviewIndex];
               const previewDisplay = document.getElementById('previewDisplay');
               const previewCounter = document.getElementById('previewCounter');
               
               previewCounter.textContent = `${currentPreviewIndex + 1}/${advertisements.length}`;
               
               previewDisplay.style.opacity = '0.5';
               
               setTimeout(() => {
                   if (ad.type === 'text') {
                       previewDisplay.style.background = ad.background || 'linear-gradient(45deg, #667eea, #764ba2)';
                       previewDisplay.innerHTML = `<div class="preview-text">${ad.content}</div>`;
                   } else if (ad.type === 'image') {
                       previewDisplay.style.background = '#000';
                       previewDisplay.innerHTML = `<img src="${ad.src}" style="max-width: 100%; max-height: 100%; object-fit: contain;" alt="Ad Preview">`;
                   } else if (ad.type === 'video') {
                       previewDisplay.style.background = '#000';
                       previewDisplay.innerHTML = `<video src="${ad.src}" style="max-width: 100%; max-height: 100%; object-fit: contain;" controls muted></video>`;
                   }
                   
                   previewDisplay.style.opacity = '1';
               }, 300);
           } catch (error) {
               console.error('‚ùå Update preview error:', error);
           }
       }

       function nextPreview() {
           if (advertisements.length === 0) return;
           currentPreviewIndex = (currentPreviewIndex + 1) % advertisements.length;
           updatePreview();
       }

       function prevPreview() {
           if (advertisements.length === 0) return;
           currentPreviewIndex = currentPreviewIndex > 0 ? currentPreviewIndex - 1 : advertisements.length - 1;
           updatePreview();
       }

       // === DASHBOARD ===
       function updateDashboard() {
           try {
               document.getElementById('totalAds').textContent = advertisements.length;
               document.getElementById('syncCount').textContent = syncCounter;
               
               const settings = JSON.parse(localStorage.getItem('vipart_settings') || '{}');
               document.getElementById('apiStatus').textContent = settings.apiKey ? '‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå' : '‡∏≠‡∏≠‡∏ü‡πÑ‡∏•‡∏ô‡πå';
               
               const lastUpdate = localStorage.getItem('vipart_last_update');
               if (lastUpdate) {
                   const date = new Date(parseInt(lastUpdate));
                   document.getElementById('lastUpdate').textContent = date.toLocaleString('th-TH');
               } else {
                   document.getElementById('lastUpdate').textContent = '‡πÑ‡∏°‡πà‡πÄ‡∏Ñ‡∏¢';
               }
               
               console.log('üìä ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î');
           } catch (error) {
               console.error('‚ùå Update dashboard error:', error);
           }
       }

       // === API CONFIGURATION ===
       function testApi() {
           try {
               const apiKey = document.getElementById('apiKey').value.trim();
               const city = document.getElementById('city').value.trim();
               const state = document.getElementById('state').value.trim();
               const country = document.getElementById('country').value.trim();
               
               if (!apiKey) {
                   showAlert('error', '‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà API Key');
                   return;
               }
               
               if (!city || !country) {
                   showAlert('error', '‚ùå ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÅ‡∏•‡∏∞‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®');
                   return;
               }
               
               showAlert('info', 'üîÑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ API...');
               
               const url = `https://api.airvisual.com/v2/city?city=${encodeURIComponent(city)}&state=${encodeURIComponent(state || city)}&country=${encodeURIComponent(country)}&key=${apiKey}`;
               
               fetch(url, { signal: AbortSignal.timeout(15000) })
                   .then(response => {
                       if (!response.ok) {
                           throw new Error(`HTTP ${response.status}`);
                       }
                       return response.json();
                   })
                   .then(data => {
                       if (data && data.status === 'success' && data.data) {
                           const { current, city, state, country } = data.data;
                           const { pollution, weather } = current;
                           
                           showAlert('success', `
                               ‚úÖ ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!<br><br>
                               üìç ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà: ${city}, ${state}, ${country}<br>
                               üå¨Ô∏è AQI: ${pollution.aqius}<br>
                               üå´Ô∏è PM2.5: ${pollution.pm25?.v || 'N/A'} Œºg/m¬≥<br>
                               üå°Ô∏è ‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥: ${weather.tp || 'N/A'}¬∞C<br>
                               üíß ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡∏∑‡πâ‡∏ô: ${weather.hu || 'N/A'}%
                           `);
                       } else {
                           throw new Error('API returned invalid data');
                       }
                   })
                   .catch(error => {
                       console.error('‚ùå API Test error:', error);
                       let errorMsg = '‚ùå ‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß<br><br>';
                       if (error.message.includes('Invalid API key')) {
                           errorMsg += 'API Key ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á';
                       } else if (error.message.includes('call_limit_reached')) {
                           errorMsg += '‡πÉ‡∏ä‡πâ API ‡πÄ‡∏Å‡∏¥‡∏ô‡∏Ç‡∏µ‡∏î‡∏à‡∏≥‡∏Å‡∏±‡∏î';
                       } else if (error.message.includes('city_not_found')) {
                           errorMsg += '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πâ';
                       } else {
                           errorMsg += '‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏≠‡∏¥‡∏ô‡πÄ‡∏ó‡∏≠‡∏£‡πå‡πÄ‡∏ô‡πá‡∏ï';
                       }
                       showAlert('error', errorMsg);
                   });
                   
           } catch (error) {
               console.error('‚ùå Test API error:', error);
               showAlert('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö');
           }
       }

       function saveApiConfig() {
           try {
               const apiKey = document.getElementById('apiKey').value.trim();
               const city = document.getElementById('city').value.trim();
               const state = document.getElementById('state').value.trim();
               const country = document.getElementById('country').value.trim();
               
               if (!apiKey || !city || !country) {
                   showAlert('error', '‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô');
                   return;
               }
               
               const settings = {
                   apiKey: apiKey,
                   updateInterval: parseInt(document.getElementById('updateInterval')?.value) || 10,
                   adInterval: parseInt(document.getElementById('adInterval')?.value) || 15
               };
               
               const location = {
                   city: city,
                   state: state || city,
                   country: country
               };
               
               localStorage.setItem('vipart_settings', JSON.stringify(settings));
               localStorage.setItem('vipart_location', JSON.stringify(location));
               
               notifyMainPage();
               updateDashboard();
               showAlert('success', 'üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å API Configuration ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
               
           } catch (error) {
               console.error('‚ùå Save API config error:', error);
               showAlert('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å');
           }
       }

       function toggleApiKeyVisibility() {
           const apiKeyInput = document.getElementById('apiKey');
           if (apiKeyInput.type === 'password') {
               apiKeyInput.type = 'text';
           } else {
               apiKeyInput.type = 'password';
           }
       }

       // === SYSTEM SETTINGS ===
       function saveSystemSettings() {
           try {
               const updateInterval = parseInt(document.getElementById('updateInterval').value);
               const adInterval = parseInt(document.getElementById('adInterval').value);
               const maxFileSize = parseInt(document.getElementById('maxFileSize').value);
               
               if (updateInterval < 1 || updateInterval > 60) {
                   showAlert('error', '‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó AQI ‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 1-60 ‡∏ô‡∏≤‡∏ó‡∏µ');
                   return;
               }
               
               if (adInterval < 5 || adInterval > 120) {
                   showAlert('error', '‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡∏´‡∏°‡∏∏‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á 5-120 ‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ');
                   return;
               }
               
               const settings = JSON.parse(localStorage.getItem('vipart_settings') || '{}');
               settings.updateInterval = updateInterval;
               settings.adInterval = adInterval;
               settings.maxFileSize = maxFileSize * 1024 * 1024;
               
               localStorage.setItem('vipart_settings', JSON.stringify(settings));
               
               notifyMainPage();
               updateDashboard();
               showAlert('success', 'üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
               
           } catch (error) {
               console.error('‚ùå Save system settings error:', error);
               showAlert('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤');
           }
       }

       // === DATA MANAGEMENT ===
       function exportAds() {
           try {
               const data = {
                   advertisements: advertisements,
                   exportDate: new Date().toISOString(),
                   version: '3.0',
                   syncCounter: syncCounter
               };
               
               const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
               const url = URL.createObjectURL(blob);
               const a = document.createElement('a');
               a.href = url;
               a.download = `vipart-ads-v3.0-${new Date().toISOString().split('T')[0]}.json`;
               a.click();
               URL.revokeObjectURL(url);
               
               showAlert('success', 'üì§ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
           } catch (error) {
               console.error('‚ùå Export ads error:', error);
               showAlert('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å');
           }
       }

       function importAds() {
           document.getElementById('importFile').click();
       }

       function handleImportFile(event) {
           try {
               const file = event.target.files[0];
               if (!file) return;
               
               const reader = new FileReader();
               reader.onload = function(e) {
                   try {
                       const data = JSON.parse(e.target.result);
                       
                       if (data.advertisements && Array.isArray(data.advertisements)) {
                           if (confirm(`üì• ‡∏û‡∏ö‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ ${data.advertisements.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£\n\n‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡πÅ‡∏•‡∏∞‡πÅ‡∏ó‡∏ô‡∏ó‡∏µ‡πà‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) {
                               advertisements = data.advertisements;
                               saveAdvertisements();
                               renderAdList();
                               updateDashboard();
                               updatePreview();
                               notifyMainPage();
                               showAlert('success', `üì• ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ ${advertisements.length} ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!`);
                           }
                       } else {
                           showAlert('error', '‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
                       }
                   } catch (error) {
                       showAlert('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡πà‡∏≤‡∏ô‡πÑ‡∏ü‡∏•‡πå');
                   }
               };
               reader.readAsText(file);
               
               event.target.value = '';
           } catch (error) {
               console.error('‚ùå Import file error:', error);
           }
       }

       function exportAllData() {
           try {
               const settings = JSON.parse(localStorage.getItem('vipart_settings') || '{}');
               const location = JSON.parse(localStorage.getItem('vipart_location') || '{}');
               
               const data = {
                   advertisements: advertisements,
                   settings: settings,
                   location: location,
                   exportDate: new Date().toISOString(),
                   version: '3.0',
                   syncCounter: syncCounter
               };
               
               const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
               const url = URL.createObjectURL(blob);
               const a = document.createElement('a');
               a.href = url;
               a.download = `vipart-backup-v3.0-${new Date().toISOString().split('T')[0]}.json`;
               a.click();
               URL.revokeObjectURL(url);
               
               showAlert('success', 'üì§ ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
           } catch (error) {
               console.error('‚ùå Export all error:', error);
               showAlert('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å');
           }
       }

       function clearAllAds() {
           if (confirm('üóëÔ∏è ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
               advertisements = [];
               saveAdvertisements();
               renderAdList();
               updateDashboard();
               updatePreview();
               notifyMainPage();
               showAlert('success', 'üóëÔ∏è ‡∏•‡∏ö‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');
           }
       }

       function clearAllData() {
           if (confirm('üóëÔ∏è ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?\n\n‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ!')) {
               if (confirm('‚ö†Ô∏è ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á - ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?')) {
                   localStorage.removeItem('vipart_advertisements');
                   localStorage.removeItem('vipart_settings');
                   localStorage.removeItem('vipart_location');
                   localStorage.removeItem('vipart_draft_content');
                   
                   advertisements = [];
                   syncCounter = 0;
                   
                   // Reset forms
                   document.getElementById('apiKey').value = '';
                   document.getElementById('city').value = 'Bangkok';
                   document.getElementById('state').value = 'Bangkok';
                   document.getElementById('country').value = 'Thailand';
                   resetAdForm();
                   
                   renderAdList();
                   updateDashboard();
                   updatePreview();
                   notifyMainPage();
                   showAlert('success', 'üóëÔ∏è ‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß!');
               }
           }
       }

       // === SYNC SYSTEM ===
       function notifyMainPage() {
           try {
               syncCounter++;
               console.log(`üì° ‡∏™‡πà‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å (‡∏Ñ‡∏£‡∏±‡πâ‡∏á‡∏ó‡∏µ‡πà ${syncCounter})`);
               
               const timestamp = Date.now().toString();
               
               // localStorage sync
               localStorage.setItem('vipart_force_reload', timestamp);
               localStorage.setItem('vipart_last_update', timestamp);
               
               // BroadcastChannel sync
               try {
                   if (typeof BroadcastChannel !== 'undefined') {
                       const channel = new BroadcastChannel('vipart_updates');
                       channel.postMessage({
                           type: 'admin_update',
                           action: 'force_reload',
                           advertisements: advertisements,
                           timestamp: Date.now(),
                           syncCounter: syncCounter,
                           source: 'admin_panel_v3.0'
                       });
                       channel.close();
                   }
               } catch (e) {
                   console.warn('‚ö†Ô∏è BroadcastChannel sync ‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
               }
               
               updateStatusIndicator('success', `‚úÖ Sync #${syncCounter}`);
               updateDashboard();
               
               console.log(`üì° ‡∏™‡πà‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡πÅ‡∏•‡πâ‡∏ß (Sync #${syncCounter})`);
               
           } catch (error) {
               console.error('‚ùå Notify main page error:', error);
               updateStatusIndicator('error', '‚ùå Sync Error');
           }
       }

       function testSync() {
           try {
               notifyMainPage();
               showAlert('success', 'üß™ ‡∏™‡πà‡∏á‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß! ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•');
           } catch (error) {
               console.error('‚ùå Test sync error:', error);
               showAlert('error', '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ó‡∏î‡∏™‡∏≠‡∏ö');
           }
       }

       // === MAIN PAGE FUNCTIONS ===
       function openMainPage() {
           const mainPageUrl = window.location.href.replace('admin.html', 'index.html');
           window.open(mainPageUrl, '_blank');
       }

       function openMainPageFullscreen() {
           const mainPageUrl = window.location.href.replace('admin.html', 'index.html');
           window.open(mainPageUrl, '_blank', 'fullscreen=yes,scrollbars=no,menubar=no,toolbar=no,location=no,status=no');
       }

       function copyMainPageUrl() {
           try {
               const mainPageUrl = window.location.href.replace('admin.html', 'index.html');
               navigator.clipboard.writeText(mainPageUrl).then(() => {
                   showAlert('success', 'üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å URL ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!');
               }).catch(() => {
                   // Fallback for older browsers
                   const textarea = document.createElement('textarea');
                   textarea.value = mainPageUrl;
                   document.body.appendChild(textarea);
                   textarea.select();
                   document.execCommand('copy');
                   document.body.removeChild(textarea);
                   showAlert('success', 'üìã ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å URL ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!');
               });
           } catch (error) {
               console.error('‚ùå Copy URL error:', error);
               showAlert('error', '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å URL ‡πÑ‡∏î‡πâ');
           }
       }

       // === UTILITY FUNCTIONS ===
       function showAlert(type, message) {
           try {
               console.log(`${type === 'success' ? '‚úÖ' : '‚ùå'} Alert:`, message);
               
               const alertElement = document.createElement('div');
               alertElement.className = `alert alert-${type} show`;
               alertElement.innerHTML = message;
               
               // Insert after page title
               const contentArea = document.querySelector('.content-area');
               contentArea.insertBefore(alertElement, contentArea.firstChild);
               
               // Auto-remove
               setTimeout(() => {
                   if (alertElement.parentNode) {
                       alertElement.parentNode.removeChild(alertElement);
                   }
               }, type === 'success' ? 5000 : 8000);
               
           } catch (error) {
               console.error('‚ùå Show alert error:', error);
               alert(`${type === 'success' ? '‚úÖ' : '‚ùå'} ${message}`);
           }
       }

       function updateStatusIndicator(type, message) {
           try {
               const indicator = document.getElementById('statusIndicator');
               indicator.className = `status-indicator ${type}`;
               indicator.textContent = message;
               
               setTimeout(() => {
                   indicator.textContent = 'üîÑ ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°';
                   indicator.className = 'status-indicator';
               }, 3000);
           } catch (error) {
               console.error('‚ùå Update status error:', error);
           }
       }

       function saveCurrentTab() {
           // Save based on current active tab
           const activeTab = document.querySelector('.nav-link.active')?.dataset.tab;
           switch (activeTab) {
               case 'api':
                   saveApiConfig();
                   break;
               case 'ads':
                   addNewAd();
                   break;
               case 'settings':
                   saveSystemSettings();
                   break;
               default:
                   testSync();
           }
       }

       // === CLOUD SYNC FUNCTIONS (Placeholder) ===
       function setupGoogleSheets() {
           showAlert('info', 'Google Sheets Sync - ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤');
       }

       function syncFromSheets() {
           showAlert('info', 'Sync from Sheets - ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤');
       }

       function testGoogleSheets() {
           showAlert('info', 'Test Google Sheets - ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤');
       }

       function setupCloudSync() {
           showAlert('info', 'Cloud Sync Setup - ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤');
       }

       function syncToCloud() {
           showAlert('info', 'Sync to Cloud - ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤');
       }

       function syncFromCloud() {
           showAlert('info', 'Sync from Cloud - ‡∏ü‡∏µ‡πÄ‡∏à‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏û‡∏±‡∏í‡∏ô‡∏≤');
       }

       console.log('üéØ Digital Signage Pro v3.0 Admin Panel ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô!');
       console.log('‚å®Ô∏è Keyboard shortcuts:');
       console.log('   Ctrl+S = Save current tab');
       console.log('   Ctrl+R = Test Sync');
       console.log('   Ctrl+P = Open main page');
   </script>
</body>
</html>
