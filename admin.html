<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ - Air Quality Signage</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Kanit', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            color: #333;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #667eea;
        }
        
        .form-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-family: 'Kanit', Arial, sans-serif;
        }
        
        textarea {
            height: 100px;
            resize: vertical;
        }
        
        button {
            background: #667eea;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-family: 'Kanit', Arial, sans-serif;
            font-weight: 600;
        }
        
        button:hover {
            background: #5a6fd8;
        }
        
        .ad-list {
            display: grid;
            gap: 15px;
        }
        
        .ad-item {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .ad-preview {
            flex: 1;
            margin-right: 15px;
        }
        
        .ad-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn-danger {
            background: #dc3545;
        }
        
        .btn-danger:hover {
            background: #c82333;
        }
        
        .back-link {
            display: inline-block;
            margin-bottom: 20px;
            color: #667eea;
            text-decoration: none;
        }
        
        .settings-section {
            background: #e8f4f8;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="index.html" class="back-link">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</a>
        
        <h1>üõ†Ô∏è ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</h1>
        
        <!-- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ API -->
        <div class="settings-section">
            <h2>‚öôÔ∏è ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ API</h2>
            <div class="form-group">
                <label for="api-key">IQAir API Key:</label>
                <input type="text" id="api-key" placeholder="‡πÉ‡∏™‡πà API Key ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì">
            </div>
            <div class="form-group">
                <label for="city">‡πÄ‡∏°‡∏∑‡∏≠‡∏á:</label>
                <input type="text" id="city" value="Bangkok">
            </div>
            <button onclick="saveSettings()">üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</button>
        </div>
        
        <!-- ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ -->
        <div class="form-section">
            <h2>‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡πÉ‡∏´‡∏°‡πà</h2>
            <div class="form-group">
                <label for="ad-type">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤:</label>
                <select id="ad-type" onchange="toggleAdForm()">
                    <option value="text">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</option>
                    <option value="image">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û</option>
                </select>
            </div>
            
            <div id="text-form">
                <div class="form-group">
                    <label for="ad-content">‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤:</label>
                    <textarea id="ad-content" placeholder="‡πÉ‡∏™‡πà‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ (‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÉ‡∏ä‡πâ HTML ‡πÑ‡∏î‡πâ)"></textarea>
                </div>
                <div class="form-group">
                    <label for="ad-background">‡∏™‡∏µ‡∏û‡∏∑‡πâ‡∏ô‡∏´‡∏•‡∏±‡∏á (Gradient CSS):</label>
                    <input type="text" id="ad-background" placeholder="linear-gradient(45deg, #ff6b6b, #4ecdc4)">
                </div>
            </div>
            
            <div id="image-form" style="display: none;">
                <div class="form-group">
                    <label for="ad-image">‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û:</label>
                    <input type="file" id="ad-image" accept="image/*">
                </div>
            </div>
            
            <div class="form-group">
                <label for="ad-duration">‡∏£‡∏∞‡∏¢‡∏∞‡πÄ‡∏ß‡∏•‡∏≤‡πÅ‡∏™‡∏î‡∏á (‡∏ß‡∏¥‡∏ô‡∏≤‡∏ó‡∏µ):</label>
                <input type="number" id="ad-duration" value="15" min="5" max="60">
            </div>
            
            <button onclick="addAdvertisement()">‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤</button>
        </div>
        
        <!-- ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤ -->
        <div class="form-section">
            <h2>üìã ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô</h2>
            <div id="ad-list" class="ad-list">
                <!-- ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÇ‡∏´‡∏•‡∏î‡∏î‡πâ‡∏ß‡∏¢ JavaScript -->
            </div>
        </div>
    </div>

    <script>
        let advertisements = [];
        
        // ‡πÇ‡∏´‡∏•‡∏î‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
        async function loadAdvertisements() {
            try {
                const response = await fetch('/api/get-ads');
                const data = await response.json();
                advertisements = data.ads || [];
                renderAdList();
            } catch (error) {
                console.error('Error loading ads:', error);
                advertisements = [];
                renderAdList();
            }
        }
        
        // ‡πÅ‡∏™‡∏î‡∏á‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤
        function renderAdList() {
            const adList = document.getElementById('ad-list');
            
            if (advertisements.length === 0) {
                adList.innerHTML = '<div style="text-align: center; color: #999;">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤</div>';
                return;
            }
            
            adList.innerHTML = advertisements.map((ad, index) => `
                <div class="ad-item">
                    <div class="ad-preview">
                        <strong>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</strong> ${ad.type === 'text' ? '‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°' : '‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û'}<br>
                        ${ad.type === 'text' ? 
                            `<div style="margin-top: 10px;">${ad.content}</div>` : 
                            `<img src="${ad.src}" style="max-width: 200px; max-height: 100px;" alt="Ad Preview">`
                        }
                    </div>
                    <div class="ad-actions">
                        <button onclick="editAd(${index})">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                        <button class="btn-danger" onclick="deleteAd(${index})">üóëÔ∏è ‡∏•‡∏ö</button>
                    </div>
                </div>
            `).join('');
        }
        
        // ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤
        async function addAdvertisement() {
            const type = document.getElementById('ad-type').value;
            const duration = parseInt(document.getElementById('ad-duration').value) * 1000;
            
            let adData = { type, duration };
            
            if (type === 'text') {
                adData.content = document.getElementById('ad-content').value;
                adData.background = document.getElementById('ad-background').value || 'linear-gradient(45deg, #ff6b6b, #4ecdc4)';
            } else if (type === 'image') {
                const fileInput = document.getElementById('ad-image');
                if (!fileInput.files[0]) {
                    alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û');
                    return;
                }
                
                // ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
                const formData = new FormData();
                formData.append('image', fileInput.files[0]);
                
                try {
                    const uploadResponse = await fetch('/api/upload-image', {
                        method: 'POST',
                        body: formData
                    });
                    const uploadData = await uploadResponse.json();
                    adData.src = uploadData.url;
                } catch (error) {
                    alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û');
                    return;
                }
            }
            
            advertisements.push(adData);
            await saveAdvertisements();
            resetForm();
            loadAdvertisements();
        }
        
        // ‡∏•‡∏ö‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤
        async function deleteAd(index) {
            if (confirm('‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏•‡∏ö‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏ô‡∏µ‡πâ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?')) {
                advertisements.splice(index, 1);
                await saveAdvertisements();
                loadAdvertisements();
            }
        }
        
        // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤
        async function saveAdvertisements() {
            try {
                await fetch('/api/save-ads', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ ads: advertisements })
                });
                alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
            } catch (error) {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å');
            }
        }
        
        // ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
        async function saveSettings() {
            const apiKey = document.getElementById('api-key').value;
            const city = document.getElementById('city').value;
            
            try {
                await fetch('/api/save-settings', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ apiKey, city })
                });
                alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
            } catch (error) {
                alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤');
            }
        }
        
        // ‡∏™‡∏•‡∏±‡∏ö‡∏ü‡∏≠‡∏£‡πå‡∏°
        function toggleAdForm() {
            const type = document.getElementById('ad-type').value;
            document.getElementById('text-form').style.display = type === 'text' ? 'block' : 'none';
            document.getElementById('image-form').style.display = type === 'image' ? 'block' : 'none';
        }
        
        // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ü‡∏≠‡∏£‡πå‡∏°
        function resetForm() {
            document.getElementById('ad-content').value = '';
            document.getElementById('ad-background').value = '';
            document.getElementById('ad-image').value = '';
            document.getElementById('ad-duration').value = '15';
        }
        
        // ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
        document.addEventListener('DOMContentLoaded', loadAdvertisements);
    </script>
</body>
</html>